<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Manish Saraswat" />

<meta name="date" content="2019-03-16" />

<title>Introduction to SuperML</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to SuperML</h1>
<h4 class="author"><em>Manish Saraswat</em></h4>
<h4 class="date"><em>2019-03-16</em></h4>



<p>SuperML R package is designed to unify the model training process in R like Python. Generally, it’s seen that people spend lot of time in searching for packages, figuring out the syntax for training machine learning models in R. This behaviour is highly apparent in users who frequently switch between R and Python. This package provides a python´s scikit-learn interface (<code>fit</code>, <code>predict</code>) to train models faster.</p>
<p>In addition to building machine learning models, there are handy functionalities to do feature engineering</p>
<p>This ambitious package is my ongoing effort to help the r-community build ML models easily and faster in R.</p>
<div id="install" class="section level2">
<h2>Install</h2>
<p>You can install latest cran version using (recommended):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;superml&quot;</span>)</code></pre></div>
<p>You can install the developmemt version directly from github using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;saraswatmks/superml&quot;</span>)</code></pre></div>
</div>
<div id="examples---machine-learning-models" class="section level2">
<h2>Examples - Machine Learning Models</h2>
<p>This package uses existing r-packages to build machine learning model. In this tutorial, we’ll use data.table R package to do all tasks related to data manipulation.</p>
<div id="regression-data" class="section level3">
<h3>Regression Data</h3>
<p>We’ll quickly prepare the data set to be ready to served for model training.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;../data/reg_train.rda&quot;</span>)
<span class="co"># if the above doesn't work, you can try: load(&quot;reg_train.rda&quot;)</span>

<span class="kw">library</span>(data.table)
<span class="kw">library</span>(caret)
<span class="co">#&gt; Loading required package: lattice</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="kw">library</span>(superml)
<span class="co">#&gt; Loading required package: R6</span>

<span class="kw">library</span>(Metrics)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'Metrics'</span>
<span class="co">#&gt; The following objects are masked from 'package:caret':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     precision, recall</span>

<span class="kw">head</span>(reg_train)
<span class="co">#&gt;    Id MSSubClass MSZoning LotFrontage LotArea Street Alley LotShape</span>
<span class="co">#&gt; 1:  1         60       RL          65    8450   Pave  &lt;NA&gt;      Reg</span>
<span class="co">#&gt; 2:  2         20       RL          80    9600   Pave  &lt;NA&gt;      Reg</span>
<span class="co">#&gt; 3:  3         60       RL          68   11250   Pave  &lt;NA&gt;      IR1</span>
<span class="co">#&gt; 4:  4         70       RL          60    9550   Pave  &lt;NA&gt;      IR1</span>
<span class="co">#&gt; 5:  5         60       RL          84   14260   Pave  &lt;NA&gt;      IR1</span>
<span class="co">#&gt; 6:  6         50       RL          85   14115   Pave  &lt;NA&gt;      IR1</span>
<span class="co">#&gt;    LandContour Utilities LotConfig LandSlope Neighborhood Condition1</span>
<span class="co">#&gt; 1:         Lvl    AllPub    Inside       Gtl      CollgCr       Norm</span>
<span class="co">#&gt; 2:         Lvl    AllPub       FR2       Gtl      Veenker      Feedr</span>
<span class="co">#&gt; 3:         Lvl    AllPub    Inside       Gtl      CollgCr       Norm</span>
<span class="co">#&gt; 4:         Lvl    AllPub    Corner       Gtl      Crawfor       Norm</span>
<span class="co">#&gt; 5:         Lvl    AllPub       FR2       Gtl      NoRidge       Norm</span>
<span class="co">#&gt; 6:         Lvl    AllPub    Inside       Gtl      Mitchel       Norm</span>
<span class="co">#&gt;    Condition2 BldgType HouseStyle OverallQual OverallCond YearBuilt</span>
<span class="co">#&gt; 1:       Norm     1Fam     2Story           7           5      2003</span>
<span class="co">#&gt; 2:       Norm     1Fam     1Story           6           8      1976</span>
<span class="co">#&gt; 3:       Norm     1Fam     2Story           7           5      2001</span>
<span class="co">#&gt; 4:       Norm     1Fam     2Story           7           5      1915</span>
<span class="co">#&gt; 5:       Norm     1Fam     2Story           8           5      2000</span>
<span class="co">#&gt; 6:       Norm     1Fam     1.5Fin           5           5      1993</span>
<span class="co">#&gt;    YearRemodAdd RoofStyle RoofMatl Exterior1st Exterior2nd MasVnrType</span>
<span class="co">#&gt; 1:         2003     Gable  CompShg     VinylSd     VinylSd    BrkFace</span>
<span class="co">#&gt; 2:         1976     Gable  CompShg     MetalSd     MetalSd       None</span>
<span class="co">#&gt; 3:         2002     Gable  CompShg     VinylSd     VinylSd    BrkFace</span>
<span class="co">#&gt; 4:         1970     Gable  CompShg     Wd Sdng     Wd Shng       None</span>
<span class="co">#&gt; 5:         2000     Gable  CompShg     VinylSd     VinylSd    BrkFace</span>
<span class="co">#&gt; 6:         1995     Gable  CompShg     VinylSd     VinylSd       None</span>
<span class="co">#&gt;    MasVnrArea ExterQual ExterCond Foundation BsmtQual BsmtCond</span>
<span class="co">#&gt; 1:        196        Gd        TA      PConc       Gd       TA</span>
<span class="co">#&gt; 2:          0        TA        TA     CBlock       Gd       TA</span>
<span class="co">#&gt; 3:        162        Gd        TA      PConc       Gd       TA</span>
<span class="co">#&gt; 4:          0        TA        TA     BrkTil       TA       Gd</span>
<span class="co">#&gt; 5:        350        Gd        TA      PConc       Gd       TA</span>
<span class="co">#&gt; 6:          0        TA        TA       Wood       Gd       TA</span>
<span class="co">#&gt;    BsmtExposure BsmtFinType1 BsmtFinSF1 BsmtFinType2 BsmtFinSF2 BsmtUnfSF</span>
<span class="co">#&gt; 1:           No          GLQ        706          Unf          0       150</span>
<span class="co">#&gt; 2:           Gd          ALQ        978          Unf          0       284</span>
<span class="co">#&gt; 3:           Mn          GLQ        486          Unf          0       434</span>
<span class="co">#&gt; 4:           No          ALQ        216          Unf          0       540</span>
<span class="co">#&gt; 5:           Av          GLQ        655          Unf          0       490</span>
<span class="co">#&gt; 6:           No          GLQ        732          Unf          0        64</span>
<span class="co">#&gt;    TotalBsmtSF Heating HeatingQC CentralAir Electrical 1stFlrSF 2ndFlrSF</span>
<span class="co">#&gt; 1:         856    GasA        Ex          Y      SBrkr      856      854</span>
<span class="co">#&gt; 2:        1262    GasA        Ex          Y      SBrkr     1262        0</span>
<span class="co">#&gt; 3:         920    GasA        Ex          Y      SBrkr      920      866</span>
<span class="co">#&gt; 4:         756    GasA        Gd          Y      SBrkr      961      756</span>
<span class="co">#&gt; 5:        1145    GasA        Ex          Y      SBrkr     1145     1053</span>
<span class="co">#&gt; 6:         796    GasA        Ex          Y      SBrkr      796      566</span>
<span class="co">#&gt;    LowQualFinSF GrLivArea BsmtFullBath BsmtHalfBath FullBath HalfBath</span>
<span class="co">#&gt; 1:            0      1710            1            0        2        1</span>
<span class="co">#&gt; 2:            0      1262            0            1        2        0</span>
<span class="co">#&gt; 3:            0      1786            1            0        2        1</span>
<span class="co">#&gt; 4:            0      1717            1            0        1        0</span>
<span class="co">#&gt; 5:            0      2198            1            0        2        1</span>
<span class="co">#&gt; 6:            0      1362            1            0        1        1</span>
<span class="co">#&gt;    BedroomAbvGr KitchenAbvGr KitchenQual TotRmsAbvGrd Functional</span>
<span class="co">#&gt; 1:            3            1          Gd            8        Typ</span>
<span class="co">#&gt; 2:            3            1          TA            6        Typ</span>
<span class="co">#&gt; 3:            3            1          Gd            6        Typ</span>
<span class="co">#&gt; 4:            3            1          Gd            7        Typ</span>
<span class="co">#&gt; 5:            4            1          Gd            9        Typ</span>
<span class="co">#&gt; 6:            1            1          TA            5        Typ</span>
<span class="co">#&gt;    Fireplaces FireplaceQu GarageType GarageYrBlt GarageFinish GarageCars</span>
<span class="co">#&gt; 1:          0        &lt;NA&gt;     Attchd        2003          RFn          2</span>
<span class="co">#&gt; 2:          1          TA     Attchd        1976          RFn          2</span>
<span class="co">#&gt; 3:          1          TA     Attchd        2001          RFn          2</span>
<span class="co">#&gt; 4:          1          Gd     Detchd        1998          Unf          3</span>
<span class="co">#&gt; 5:          1          TA     Attchd        2000          RFn          3</span>
<span class="co">#&gt; 6:          0        &lt;NA&gt;     Attchd        1993          Unf          2</span>
<span class="co">#&gt;    GarageArea GarageQual GarageCond PavedDrive WoodDeckSF OpenPorchSF</span>
<span class="co">#&gt; 1:        548         TA         TA          Y          0          61</span>
<span class="co">#&gt; 2:        460         TA         TA          Y        298           0</span>
<span class="co">#&gt; 3:        608         TA         TA          Y          0          42</span>
<span class="co">#&gt; 4:        642         TA         TA          Y          0          35</span>
<span class="co">#&gt; 5:        836         TA         TA          Y        192          84</span>
<span class="co">#&gt; 6:        480         TA         TA          Y         40          30</span>
<span class="co">#&gt;    EnclosedPorch 3SsnPorch ScreenPorch PoolArea PoolQC Fence MiscFeature</span>
<span class="co">#&gt; 1:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co">#&gt; 2:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co">#&gt; 3:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co">#&gt; 4:           272         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co">#&gt; 5:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span>
<span class="co">#&gt; 6:             0       320           0        0   &lt;NA&gt; MnPrv        Shed</span>
<span class="co">#&gt;    MiscVal MoSold YrSold SaleType SaleCondition SalePrice</span>
<span class="co">#&gt; 1:       0      2   2008       WD        Normal    208500</span>
<span class="co">#&gt; 2:       0      5   2007       WD        Normal    181500</span>
<span class="co">#&gt; 3:       0      9   2008       WD        Normal    223500</span>
<span class="co">#&gt; 4:       0      2   2006       WD       Abnorml    140000</span>
<span class="co">#&gt; 5:       0     12   2008       WD        Normal    250000</span>
<span class="co">#&gt; 6:     700     10   2009       WD        Normal    143000</span>

split &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(<span class="dt">y =</span> reg_train<span class="op">$</span>SalePrice, <span class="dt">p =</span> <span class="fl">0.7</span>)
xtrain &lt;-<span class="st"> </span>reg_train[split<span class="op">$</span>Resample1]
xtest &lt;-<span class="st"> </span>reg_train[<span class="op">!</span>split<span class="op">$</span>Resample1]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># remove features with 90% or more missing values</span>
<span class="co"># we will also remove the Id column because it doesn't contain</span>
<span class="co"># any useful information</span>
na_cols &lt;-<span class="st"> </span><span class="kw">colSums</span>(<span class="kw">is.na</span>(xtrain)) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(xtrain)
na_cols &lt;-<span class="st"> </span><span class="kw">names</span>(na_cols[<span class="kw">which</span>(na_cols <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.9</span>)])

xtrain[, <span class="kw">c</span>(na_cols, <span class="st">&quot;Id&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NULL</span>]
xtest[, <span class="kw">c</span>(na_cols, <span class="st">&quot;Id&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NULL</span>]

<span class="co"># encode categorical variables</span>
cat_cols &lt;-<span class="st"> </span><span class="kw">names</span>(xtrain)[<span class="kw">sapply</span>(xtrain, is.character)]

<span class="cf">for</span>(c <span class="cf">in</span> cat_cols){
    lbl &lt;-<span class="st"> </span>LabelEncoder<span class="op">$</span><span class="kw">new</span>()
    lbl<span class="op">$</span><span class="kw">fit</span>(<span class="kw">c</span>(xtrain[[c]], xtest[[c]]))
    xtrain[[c]] &lt;-<span class="st"> </span>lbl<span class="op">$</span><span class="kw">transform</span>(xtrain[[c]])
    xtest[[c]] &lt;-<span class="st"> </span>lbl<span class="op">$</span><span class="kw">transform</span>(xtest[[c]])
}
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span>
<span class="co">#&gt; The data contains NA values. Imputing NA with 'NA'</span>

<span class="co"># removing noise column</span>
noise &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'GrLivArea'</span>,<span class="st">'TotalBsmtSF'</span>)

xtrain[, <span class="kw">c</span>(noise) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NULL</span>]
xtest[, <span class="kw">c</span>(noise) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NULL</span>]

<span class="co"># fill missing value with  -1</span>
xtrain[<span class="kw">is.na</span>(xtrain)] &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">1</span>
xtest[<span class="kw">is.na</span>(xtest)] &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">1</span></code></pre></div>
<p><strong>KNN Regression</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knn &lt;-<span class="st"> </span>KNNTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">k =</span> <span class="dv">2</span>,<span class="dt">prob =</span> T,<span class="dt">type =</span> <span class="st">'reg'</span>)
knn<span class="op">$</span><span class="kw">fit</span>(<span class="dt">train =</span> xtrain, <span class="dt">test =</span> xtest, <span class="dt">y =</span> <span class="st">'SalePrice'</span>)
probs &lt;-<span class="st"> </span>knn<span class="op">$</span><span class="kw">predict</span>(<span class="dt">type =</span> <span class="st">'prob'</span>)
labels &lt;-<span class="st"> </span>knn<span class="op">$</span><span class="kw">predict</span>(<span class="dt">type=</span><span class="st">'raw'</span>)
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted=</span>labels)
<span class="co">#&gt; [1] 7955.711</span></code></pre></div>
<p><strong>SVM Regression</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#predicts probabilities - must specify mc_type (&quot;OvA_hinge&quot;, &quot;AvA_hinge&quot;)</span>
svm &lt;-<span class="st"> </span>SVMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">type=</span><span class="st">&quot;ls&quot;</span>)
svm<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">'SalePrice'</span>)
<span class="co">#&gt; Removing invalid columns.  The names should not start with anumber: 1stFlrSF,2ndFlrSF,3SsnPorch</span>
pred &lt;-<span class="st"> </span>svm<span class="op">$</span><span class="kw">predict</span>(xtest)
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 39150.87</span></code></pre></div>
<p><strong>Simple Regresison</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lf &lt;-<span class="st"> </span>LMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>)
lf<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;SalePrice&quot;</span>)
<span class="kw">summary</span>(lf<span class="op">$</span>model)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; stats::glm(formula = f, family = self$family, data = X, weights = self$weights)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -351050   -13393     -520    12385   231188  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)   -3.571e+05  1.459e+06  -0.245 0.806689    </span>
<span class="co">#&gt; MSSubClass    -1.225e+02  5.848e+01  -2.094 0.036525 *  </span>
<span class="co">#&gt; MSZoning      -6.997e+02  1.388e+03  -0.504 0.614194    </span>
<span class="co">#&gt; LotFrontage   -3.533e+01  3.029e+01  -1.166 0.243709    </span>
<span class="co">#&gt; LotArea        4.195e-01  1.668e-01   2.515 0.012056 *  </span>
<span class="co">#&gt; Street        -3.691e+04  1.501e+04  -2.459 0.014112 *  </span>
<span class="co">#&gt; LotShape       8.612e+02  1.910e+03   0.451 0.652093    </span>
<span class="co">#&gt; LandContour    2.841e+03  2.087e+03   1.361 0.173735    </span>
<span class="co">#&gt; Utilities     -4.209e+04  3.170e+04  -1.328 0.184562    </span>
<span class="co">#&gt; LotConfig      8.873e+02  9.951e+02   0.892 0.372844    </span>
<span class="co">#&gt; LandSlope      4.966e+03  4.621e+03   1.075 0.282831    </span>
<span class="co">#&gt; Neighborhood  -5.274e+02  1.859e+02  -2.836 0.004663 ** </span>
<span class="co">#&gt; Condition1    -1.622e+03  7.264e+02  -2.233 0.025806 *  </span>
<span class="co">#&gt; Condition2     6.318e+02  3.276e+03   0.193 0.847129    </span>
<span class="co">#&gt; BldgType      -1.858e+02  2.465e+03  -0.075 0.939921    </span>
<span class="co">#&gt; HouseStyle     5.996e+02  1.019e+03   0.588 0.556394    </span>
<span class="co">#&gt; OverallQual    1.343e+04  1.297e+03  10.358  &lt; 2e-16 ***</span>
<span class="co">#&gt; OverallCond    6.020e+03  1.144e+03   5.264 1.75e-07 ***</span>
<span class="co">#&gt; YearBuilt      4.250e+02  7.589e+01   5.600 2.80e-08 ***</span>
<span class="co">#&gt; YearRemodAdd   7.071e+01  7.514e+01   0.941 0.346926    </span>
<span class="co">#&gt; RoofStyle      1.013e+04  1.900e+03   5.334 1.20e-07 ***</span>
<span class="co">#&gt; RoofMatl      -2.592e+04  3.029e+03  -8.556  &lt; 2e-16 ***</span>
<span class="co">#&gt; Exterior1st   -1.345e+03  5.966e+02  -2.255 0.024342 *  </span>
<span class="co">#&gt; Exterior2nd    1.954e+03  5.661e+02   3.452 0.000581 ***</span>
<span class="co">#&gt; MasVnrType     2.468e+03  1.487e+03   1.660 0.097338 .  </span>
<span class="co">#&gt; MasVnrArea     1.114e+01  6.720e+00   1.657 0.097805 .  </span>
<span class="co">#&gt; ExterQual     -5.931e+02  2.301e+03  -0.258 0.796675    </span>
<span class="co">#&gt; ExterCond     -7.290e+02  2.224e+03  -0.328 0.743166    </span>
<span class="co">#&gt; Foundation    -4.696e+03  1.860e+03  -2.525 0.011720 *  </span>
<span class="co">#&gt; BsmtQual       4.516e+03  1.360e+03   3.321 0.000931 ***</span>
<span class="co">#&gt; BsmtCond      -1.300e+03  1.736e+03  -0.749 0.454250    </span>
<span class="co">#&gt; BsmtExposure   1.575e+03  8.701e+02   1.810 0.070630 .  </span>
<span class="co">#&gt; BsmtFinType1  -7.787e+02  7.434e+02  -1.048 0.295112    </span>
<span class="co">#&gt; BsmtFinSF1     8.919e+00  5.293e+00   1.685 0.092332 .  </span>
<span class="co">#&gt; BsmtFinType2  -1.191e+03  1.009e+03  -1.180 0.238130    </span>
<span class="co">#&gt; BsmtFinSF2     1.285e+01  1.015e+01   1.266 0.205791    </span>
<span class="co">#&gt; BsmtUnfSF      4.192e+00  5.054e+00   0.829 0.407067    </span>
<span class="co">#&gt; Heating       -1.614e+03  3.663e+03  -0.441 0.659529    </span>
<span class="co">#&gt; HeatingQC     -1.787e+03  1.298e+03  -1.377 0.168929    </span>
<span class="co">#&gt; CentralAir     3.371e+03  4.932e+03   0.684 0.494407    </span>
<span class="co">#&gt; Electrical     2.062e+03  2.084e+03   0.989 0.322800    </span>
<span class="co">#&gt; `1stFlrSF`     5.752e+01  6.736e+00   8.539  &lt; 2e-16 ***</span>
<span class="co">#&gt; `2ndFlrSF`     4.945e+01  5.640e+00   8.767  &lt; 2e-16 ***</span>
<span class="co">#&gt; LowQualFinSF  -3.087e+00  1.976e+01  -0.156 0.875908    </span>
<span class="co">#&gt; BsmtFullBath   1.325e+04  2.731e+03   4.852 1.43e-06 ***</span>
<span class="co">#&gt; BsmtHalfBath  -1.603e+03  4.276e+03  -0.375 0.707892    </span>
<span class="co">#&gt; FullBath       6.742e+03  2.975e+03   2.266 0.023648 *  </span>
<span class="co">#&gt; HalfBath       2.320e+03  2.809e+03   0.826 0.409101    </span>
<span class="co">#&gt; BedroomAbvGr  -5.218e+03  1.788e+03  -2.918 0.003605 ** </span>
<span class="co">#&gt; KitchenAbvGr  -2.552e+04  5.774e+03  -4.420 1.10e-05 ***</span>
<span class="co">#&gt; KitchenQual    8.469e+03  1.746e+03   4.850 1.44e-06 ***</span>
<span class="co">#&gt; TotRmsAbvGrd   2.146e+03  1.321e+03   1.624 0.104603    </span>
<span class="co">#&gt; Functional    -3.791e+03  1.268e+03  -2.989 0.002872 ** </span>
<span class="co">#&gt; Fireplaces    -1.359e+03  2.459e+03  -0.553 0.580623    </span>
<span class="co">#&gt; FireplaceQu    4.760e+03  1.297e+03   3.670 0.000256 ***</span>
<span class="co">#&gt; GarageType     7.107e+02  1.226e+03   0.580 0.562353    </span>
<span class="co">#&gt; GarageYrBlt   -7.794e+00  5.285e+00  -1.475 0.140601    </span>
<span class="co">#&gt; GarageFinish   2.052e+03  1.380e+03   1.487 0.137271    </span>
<span class="co">#&gt; GarageCars     1.682e+04  3.248e+03   5.178 2.73e-07 ***</span>
<span class="co">#&gt; GarageArea    -7.396e+00  1.081e+01  -0.684 0.493923    </span>
<span class="co">#&gt; GarageQual     5.489e+03  3.239e+03   1.694 0.090500 .  </span>
<span class="co">#&gt; GarageCond    -3.802e+03  3.339e+03  -1.139 0.255111    </span>
<span class="co">#&gt; PavedDrive    -1.461e+03  3.024e+03  -0.483 0.629067    </span>
<span class="co">#&gt; WoodDeckSF     2.576e+01  8.695e+00   2.963 0.003122 ** </span>
<span class="co">#&gt; OpenPorchSF    3.569e+01  1.689e+01   2.113 0.034826 *  </span>
<span class="co">#&gt; EnclosedPorch  2.951e+01  1.828e+01   1.615 0.106748    </span>
<span class="co">#&gt; `3SsnPorch`    6.283e+00  3.208e+01   0.196 0.844766    </span>
<span class="co">#&gt; ScreenPorch    3.986e+01  1.824e+01   2.186 0.029062 *  </span>
<span class="co">#&gt; PoolArea       1.795e+01  2.450e+01   0.732 0.464072    </span>
<span class="co">#&gt; Fence         -1.996e+03  1.139e+03  -1.752 0.080135 .  </span>
<span class="co">#&gt; MiscVal       -3.626e+00  4.957e+00  -0.732 0.464592    </span>
<span class="co">#&gt; MoSold         5.242e+02  3.587e+02   1.461 0.144317    </span>
<span class="co">#&gt; YrSold        -3.306e+02  7.279e+02  -0.454 0.649811    </span>
<span class="co">#&gt; SaleType       2.217e+03  1.140e+03   1.944 0.052215 .  </span>
<span class="co">#&gt; SaleCondition  3.923e+02  1.278e+03   0.307 0.759016    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 857045073)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 5.8961e+12  on 1023  degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 8.1334e+11  on  949  degrees of freedom</span>
<span class="co">#&gt; AIC: 24043</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 2</span>
predictions &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">predict</span>(<span class="dt">df =</span> xtest)
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted =</span> predictions)
<span class="co">#&gt; [1] 42543.57</span></code></pre></div>
<p><strong>Lasso Regression</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lf &lt;-<span class="st"> </span>LMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">alpha=</span><span class="dv">1</span>, <span class="dt">lambda =</span> <span class="dv">1000</span>)
lf<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;SalePrice&quot;</span>)
predictions &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">predict</span>(<span class="dt">df =</span> xtest)
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted =</span> predictions)
<span class="co">#&gt; [1] 44811.36</span></code></pre></div>
<p><strong>Ridge Regression</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lf &lt;-<span class="st"> </span>LMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">alpha=</span><span class="dv">0</span>)
lf<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;SalePrice&quot;</span>)
predictions &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">predict</span>(<span class="dt">df =</span> xtest)
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted =</span> predictions)
<span class="co">#&gt; [1] 45068.47</span></code></pre></div>
<p><strong>Logistic Regression with CV</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lf &lt;-<span class="st"> </span>LMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>)
lf<span class="op">$</span><span class="kw">cv_model</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">'SalePrice'</span>, <span class="dt">nfolds =</span> <span class="dv">5</span>, <span class="dt">parallel =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; Computation done.</span>
predictions &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">cv_predict</span>(<span class="dt">df =</span> xtest)
coefs &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">get_importance</span>()
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted =</span> predictions)
<span class="co">#&gt; [1] 52081.12</span></code></pre></div>
<p><strong>Random Forest</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rf &lt;-<span class="st"> </span>RFTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">n_estimators =</span> <span class="dv">500</span>,<span class="dt">classification =</span> <span class="dv">0</span>)
rf<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;SalePrice&quot;</span>)
pred &lt;-<span class="st"> </span>rf<span class="op">$</span><span class="kw">predict</span>(<span class="dt">df =</span> xtest)
rf<span class="op">$</span><span class="kw">get_importance</span>()
<span class="co">#&gt;               tmp.order.tmp..decreasing...TRUE..</span>
<span class="co">#&gt; OverallQual                         777029590539</span>
<span class="co">#&gt; GarageCars                          486924551594</span>
<span class="co">#&gt; GarageArea                          437459061046</span>
<span class="co">#&gt; 1stFlrSF                            398940884465</span>
<span class="co">#&gt; YearBuilt                           353217593164</span>
<span class="co">#&gt; GarageYrBlt                         287282305565</span>
<span class="co">#&gt; FullBath                            242838168546</span>
<span class="co">#&gt; BsmtFinSF1                          197903119378</span>
<span class="co">#&gt; ExterQual                           188930354367</span>
<span class="co">#&gt; LotArea                             169167289090</span>
<span class="co">#&gt; TotRmsAbvGrd                        166392646455</span>
<span class="co">#&gt; YearRemodAdd                        162960595639</span>
<span class="co">#&gt; 2ndFlrSF                            155896350979</span>
<span class="co">#&gt; FireplaceQu                         147383561214</span>
<span class="co">#&gt; Fireplaces                          145202320673</span>
<span class="co">#&gt; KitchenQual                         115559879535</span>
<span class="co">#&gt; MasVnrArea                          101114402440</span>
<span class="co">#&gt; Foundation                           99595523763</span>
<span class="co">#&gt; LotFrontage                          84714106948</span>
<span class="co">#&gt; BsmtQual                             79228168082</span>
<span class="co">#&gt; BsmtFinType1                         77848264383</span>
<span class="co">#&gt; OpenPorchSF                          76173477125</span>
<span class="co">#&gt; BsmtUnfSF                            68860075715</span>
<span class="co">#&gt; WoodDeckSF                           65289339515</span>
<span class="co">#&gt; Neighborhood                         59822232929</span>
<span class="co">#&gt; Exterior2nd                          55097837654</span>
<span class="co">#&gt; HeatingQC                            47003957553</span>
<span class="co">#&gt; BedroomAbvGr                         42464358029</span>
<span class="co">#&gt; GarageType                           41329502292</span>
<span class="co">#&gt; MSSubClass                           37310483254</span>
<span class="co">#&gt; MoSold                               31551115648</span>
<span class="co">#&gt; OverallCond                          31098731619</span>
<span class="co">#&gt; Exterior1st                          30844200956</span>
<span class="co">#&gt; RoofStyle                            29970236311</span>
<span class="co">#&gt; HouseStyle                           27073576461</span>
<span class="co">#&gt; HalfBath                             26493076533</span>
<span class="co">#&gt; BsmtFullBath                         26482006341</span>
<span class="co">#&gt; PoolArea                             24130791765</span>
<span class="co">#&gt; GarageFinish                         23069021802</span>
<span class="co">#&gt; Fence                                22608569549</span>
<span class="co">#&gt; SaleCondition                        18240876259</span>
<span class="co">#&gt; MSZoning                             17807035283</span>
<span class="co">#&gt; BsmtExposure                         17705393977</span>
<span class="co">#&gt; YrSold                               17582196103</span>
<span class="co">#&gt; LotShape                             16550764236</span>
<span class="co">#&gt; MasVnrType                           13828215184</span>
<span class="co">#&gt; SaleType                             13786715152</span>
<span class="co">#&gt; LotConfig                            13237342187</span>
<span class="co">#&gt; BldgType                             11577780865</span>
<span class="co">#&gt; LandContour                           9669210656</span>
<span class="co">#&gt; GarageCond                            9307415911</span>
<span class="co">#&gt; EnclosedPorch                         8611668023</span>
<span class="co">#&gt; CentralAir                            8434865017</span>
<span class="co">#&gt; GarageQual                            8018729456</span>
<span class="co">#&gt; KitchenAbvGr                          7992065587</span>
<span class="co">#&gt; RoofMatl                              7827604887</span>
<span class="co">#&gt; ScreenPorch                           7430499029</span>
<span class="co">#&gt; BsmtCond                              7069996004</span>
<span class="co">#&gt; ExterCond                             6973108572</span>
<span class="co">#&gt; Condition1                            6772402174</span>
<span class="co">#&gt; BsmtFinSF2                            5980274444</span>
<span class="co">#&gt; PavedDrive                            5451808841</span>
<span class="co">#&gt; LandSlope                             5375662363</span>
<span class="co">#&gt; Functional                            4847109814</span>
<span class="co">#&gt; BsmtFinType2                          4668972871</span>
<span class="co">#&gt; Electrical                            3598993357</span>
<span class="co">#&gt; BsmtHalfBath                          2507052661</span>
<span class="co">#&gt; MiscVal                               2140035430</span>
<span class="co">#&gt; 3SsnPorch                             1013149382</span>
<span class="co">#&gt; Condition2                             939211208</span>
<span class="co">#&gt; Street                                 869266473</span>
<span class="co">#&gt; Heating                                757126794</span>
<span class="co">#&gt; LowQualFinSF                           742371337</span>
<span class="co">#&gt; Utilities                               21079527</span>
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 38137.25</span></code></pre></div>
<p><strong>Xgboost</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xgb &lt;-<span class="st"> </span>XGBTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">objective =</span> <span class="st">&quot;reg:linear&quot;</span>
                      , <span class="dt">n_estimators =</span> <span class="dv">500</span>
                      , <span class="dt">eval_metric =</span> <span class="st">&quot;rmse&quot;</span>
                      , <span class="dt">maximize =</span> F
                      , <span class="dt">learning_rate =</span> <span class="fl">0.1</span>
                      ,<span class="dt">max_depth =</span> <span class="dv">6</span>)
xgb<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;SalePrice&quot;</span>, <span class="dt">valid =</span> xtest)
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:176829.937500    val-rmse:184763.828125 </span>
<span class="co">#&gt; [51] train-rmse:8563.614258  val-rmse:37722.960938 </span>
<span class="co">#&gt; [101]    train-rmse:5134.214844  val-rmse:36804.046875 </span>
<span class="co">#&gt; [151]    train-rmse:3201.090332  val-rmse:36658.128906 </span>
<span class="co">#&gt; [201]    train-rmse:2054.285645  val-rmse:36623.574219 </span>
<span class="co">#&gt; [251]    train-rmse:1384.464966  val-rmse:36616.812500 </span>
<span class="co">#&gt; [301]    train-rmse:963.443542   val-rmse:36598.050781 </span>
<span class="co">#&gt; [351]    train-rmse:640.461548   val-rmse:36606.914062 </span>
<span class="co">#&gt; [401]    train-rmse:444.808289   val-rmse:36604.488281 </span>
<span class="co">#&gt; [451]    train-rmse:304.764740   val-rmse:36612.445312 </span>
<span class="co">#&gt; [500]    train-rmse:214.617828   val-rmse:36608.250000</span>
pred &lt;-<span class="st"> </span>xgb<span class="op">$</span><span class="kw">predict</span>(xtest)
<span class="kw">rmse</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>SalePrice, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 36608.25</span></code></pre></div>
<p><strong>Grid Search</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xgb &lt;-<span class="st"> </span>XGBTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">objective=</span><span class="st">&quot;reg:linear&quot;</span>)

gst &lt;-GridSearchCV<span class="op">$</span><span class="kw">new</span>(<span class="dt">trainer =</span> xgb,
                             <span class="dt">parameters =</span> <span class="kw">list</span>(<span class="dt">n_estimators =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>), <span class="dt">max_depth =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),
                             <span class="dt">n_folds =</span> <span class="dv">3</span>,
                             <span class="dt">scoring =</span> <span class="kw">c</span>(<span class="st">'accuracy'</span>,<span class="st">'auc'</span>))
gst<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">&quot;SalePrice&quot;</span>)
<span class="co">#&gt; [1] &quot;entering grid search&quot;</span>
<span class="co">#&gt; [1] &quot;In total, 4 models will be trained&quot;</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:139353.812500 </span>
<span class="co">#&gt; [10] train-rmse:14108.108398</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:139829.421875 </span>
<span class="co">#&gt; [10] train-rmse:16228.581055</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:141289.140625 </span>
<span class="co">#&gt; [10] train-rmse:15962.292969</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:139353.812500 </span>
<span class="co">#&gt; [50] train-rmse:3111.119385</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:139829.421875 </span>
<span class="co">#&gt; [50] train-rmse:4170.987305</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:141289.140625 </span>
<span class="co">#&gt; [50] train-rmse:3926.346924</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:139886.109375 </span>
<span class="co">#&gt; [10] train-rmse:27032.160156</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:140684.515625 </span>
<span class="co">#&gt; [10] train-rmse:29519.238281</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:142074.062500 </span>
<span class="co">#&gt; [10] train-rmse:30981.111328</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:139886.109375 </span>
<span class="co">#&gt; [50] train-rmse:16118.603516</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:140684.515625 </span>
<span class="co">#&gt; [50] train-rmse:17320.564453</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-rmse:142074.062500 </span>
<span class="co">#&gt; [50] train-rmse:16859.873047</span>
gst<span class="op">$</span><span class="kw">best_iteration</span>()
<span class="co">#&gt; $n_estimators</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_depth</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_avg</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_sd</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_avg</span>
<span class="co">#&gt; [1] NaN</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_sd</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p><strong>Random Search</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rf &lt;-<span class="st"> </span>RFTrainer<span class="op">$</span><span class="kw">new</span>()
rst &lt;-RandomSearchCV<span class="op">$</span><span class="kw">new</span>(<span class="dt">trainer =</span> rf,
                             <span class="dt">parameters =</span> <span class="kw">list</span>(<span class="dt">n_estimators =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>),
                             <span class="dt">max_depth =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),
                             <span class="dt">n_folds =</span> <span class="dv">3</span>,
                             <span class="dt">scoring =</span> <span class="kw">c</span>(<span class="st">'accuracy'</span>,<span class="st">'auc'</span>),
                             <span class="dt">n_iter=</span><span class="dv">3</span>)
rst<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">&quot;SalePrice&quot;</span>)
<span class="co">#&gt; [1] &quot;In total, 3 models will be trained&quot;</span>
rst<span class="op">$</span><span class="kw">best_iteration</span>()
<span class="co">#&gt; $n_estimators</span>
<span class="co">#&gt; [1] 50</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_depth</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_avg</span>
<span class="co">#&gt; [1] 0.01756106</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_sd</span>
<span class="co">#&gt; [1] 0.01272758</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_avg</span>
<span class="co">#&gt; [1] NaN</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_sd</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
</div>
<div id="binary-classification-data" class="section level3">
<h3>Binary Classification Data</h3>
<p>Here, we will solve a simple binary classification problem (predict people who survived on titanic ship). The idea here is to demonstrate how to use this package to solve classification problems.</p>
<p><strong>Data Preparation</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load class</span>
<span class="kw">load</span>(<span class="st">'../data/cla_train.rda'</span>)
<span class="co"># if the above doesn't work, you can try: load(&quot;cla_train.rda&quot;)</span>

<span class="kw">head</span>(cla_train)
<span class="co">#&gt;    PassengerId Survived Pclass</span>
<span class="co">#&gt; 1:           1        0      3</span>
<span class="co">#&gt; 2:           2        1      1</span>
<span class="co">#&gt; 3:           3        1      3</span>
<span class="co">#&gt; 4:           4        1      1</span>
<span class="co">#&gt; 5:           5        0      3</span>
<span class="co">#&gt; 6:           6        0      3</span>
<span class="co">#&gt;                                                   Name    Sex Age SibSp</span>
<span class="co">#&gt; 1:                             Braund, Mr. Owen Harris   male  22     1</span>
<span class="co">#&gt; 2: Cumings, Mrs. John Bradley (Florence Briggs Thayer) female  38     1</span>
<span class="co">#&gt; 3:                              Heikkinen, Miss. Laina female  26     0</span>
<span class="co">#&gt; 4:        Futrelle, Mrs. Jacques Heath (Lily May Peel) female  35     1</span>
<span class="co">#&gt; 5:                            Allen, Mr. William Henry   male  35     0</span>
<span class="co">#&gt; 6:                                    Moran, Mr. James   male  NA     0</span>
<span class="co">#&gt;    Parch           Ticket    Fare Cabin Embarked</span>
<span class="co">#&gt; 1:     0        A/5 21171  7.2500              S</span>
<span class="co">#&gt; 2:     0         PC 17599 71.2833   C85        C</span>
<span class="co">#&gt; 3:     0 STON/O2. 3101282  7.9250              S</span>
<span class="co">#&gt; 4:     0           113803 53.1000  C123        S</span>
<span class="co">#&gt; 5:     0           373450  8.0500              S</span>
<span class="co">#&gt; 6:     0           330877  8.4583              Q</span>

<span class="co"># split the data</span>
split &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(<span class="dt">y =</span> cla_train<span class="op">$</span>Survived,<span class="dt">p =</span> <span class="fl">0.7</span>)
xtrain &lt;-<span class="st"> </span>cla_train[split<span class="op">$</span>Resample1]
xtest &lt;-<span class="st"> </span>cla_train[<span class="op">!</span>split<span class="op">$</span>Resample1]

<span class="co"># encode categorical variables - shorter way</span>
<span class="cf">for</span>(c <span class="cf">in</span> <span class="kw">c</span>(<span class="st">'Embarked'</span>,<span class="st">'Sex'</span>,<span class="st">'Cabin'</span>)){
    lbl &lt;-<span class="st"> </span>LabelEncoder<span class="op">$</span><span class="kw">new</span>()
    lbl<span class="op">$</span><span class="kw">fit</span>(<span class="kw">c</span>(xtrain[[c]], xtest[[c]]))
    xtrain[[c]] &lt;-<span class="st"> </span>lbl<span class="op">$</span><span class="kw">transform</span>(xtrain[[c]])
    xtest[[c]] &lt;-<span class="st"> </span>lbl<span class="op">$</span><span class="kw">transform</span>(xtest[[c]])
}
<span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span>
<span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span>
<span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span>
<span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span>
<span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span>
<span class="co">#&gt; The data contains blank values. Imputing them with 'NA'</span>

<span class="co"># impute missing values</span>
xtrain[, Age <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">replace</span>(Age, <span class="kw">is.na</span>(Age), <span class="kw">median</span>(Age, <span class="dt">na.rm =</span> T))]
xtest[, Age <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">replace</span>(Age, <span class="kw">is.na</span>(Age), <span class="kw">median</span>(Age, <span class="dt">na.rm =</span> T))]

<span class="co"># drop these features</span>
to_drop &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'PassengerId'</span>,<span class="st">'Ticket'</span>,<span class="st">'Name'</span>)

xtrain &lt;-<span class="st"> </span>xtrain[,<span class="op">-</span><span class="kw">c</span>(to_drop), with=F]
xtest &lt;-<span class="st"> </span>xtest[,<span class="op">-</span><span class="kw">c</span>(to_drop), with=F]</code></pre></div>
<p>Now, our data is ready to be served for model training. Let’s do it.</p>
<p><strong>KNN Classification</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knn &lt;-<span class="st"> </span>KNNTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">k =</span> <span class="dv">2</span>,<span class="dt">prob =</span> T,<span class="dt">type =</span> <span class="st">'class'</span>)
knn<span class="op">$</span><span class="kw">fit</span>(<span class="dt">train =</span> xtrain, <span class="dt">test =</span> xtest, <span class="dt">y =</span> <span class="st">'Survived'</span>)
probs &lt;-<span class="st"> </span>knn<span class="op">$</span><span class="kw">predict</span>(<span class="dt">type =</span> <span class="st">'prob'</span>)
labels &lt;-<span class="st"> </span>knn<span class="op">$</span><span class="kw">predict</span>(<span class="dt">type=</span><span class="st">'raw'</span>)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted=</span>labels)
<span class="co">#&gt; [1] 0.6776491</span></code></pre></div>
<p><strong>Naive Bayes Classification</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nb &lt;-<span class="st"> </span>NBTrainer<span class="op">$</span><span class="kw">new</span>()
nb<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">'Survived'</span>)
pred &lt;-<span class="st"> </span>nb<span class="op">$</span><span class="kw">predict</span>(xtest)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted=</span>pred)
<span class="co">#&gt; [1] 0.710828</span></code></pre></div>
<p><strong>SVM Classification</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#predicts probabilities - must specify mc_type (&quot;OvA_hinge&quot;, &quot;AvA_hinge&quot;)</span>
svm &lt;-<span class="st"> </span>SVMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">predict.prob =</span> T, <span class="dt">type=</span><span class="st">&quot;bc&quot;</span>, <span class="dt">mc_type=</span><span class="st">&quot;OvA_hinge&quot;</span>)
svm<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">'Survived'</span>)
pred &lt;-<span class="st"> </span>svm<span class="op">$</span><span class="kw">predict</span>(xtest)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted=</span>pred[,<span class="dv">2</span>])
<span class="co">#&gt; [1] 0.784916</span>

<span class="co">#predicts labels</span>
svm &lt;-<span class="st"> </span>SVMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">predict.prob =</span> F, <span class="dt">type=</span><span class="st">&quot;bc&quot;</span>)
svm<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">'Survived'</span>)
pred &lt;-<span class="st"> </span>svm<span class="op">$</span><span class="kw">predict</span>(xtest)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted=</span>pred)
<span class="co">#&gt; [1] 0.7381008</span></code></pre></div>
<p><strong>Logistic Regression</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lf &lt;-<span class="st"> </span>LMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>)
lf<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;Survived&quot;</span>)
<span class="kw">summary</span>(lf<span class="op">$</span>model)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; stats::glm(formula = f, family = self$family, data = X, weights = self$weights)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -2.0647  -0.5139  -0.3550   0.5659   2.5979  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)  1.882835   0.667638   2.820  0.00480 ** </span>
<span class="co">#&gt; Pclass      -0.991285   0.198153  -5.003 5.66e-07 ***</span>
<span class="co">#&gt; Sex          3.014839   0.250533  12.034  &lt; 2e-16 ***</span>
<span class="co">#&gt; Age         -0.050270   0.010402  -4.833 1.35e-06 ***</span>
<span class="co">#&gt; SibSp       -0.376242   0.132598  -2.837  0.00455 ** </span>
<span class="co">#&gt; Parch       -0.137521   0.146524  -0.939  0.34796    </span>
<span class="co">#&gt; Fare         0.001671   0.002794   0.598  0.54981    </span>
<span class="co">#&gt; Cabin        0.017868   0.005923   3.017  0.00256 ** </span>
<span class="co">#&gt; Embarked     0.076637   0.148818   0.515  0.60657    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 823.56  on 623  degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 495.21  on 615  degrees of freedom</span>
<span class="co">#&gt; AIC: 513.21</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 5</span>
predictions &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">predict</span>(<span class="dt">df =</span> xtest)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted =</span> predictions)
<span class="co">#&gt; [1] 0.7930805</span></code></pre></div>
<p><strong>Lasso Logistic Regression</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lf &lt;-<span class="st"> </span>LMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="dt">alpha=</span><span class="dv">1</span>)
lf<span class="op">$</span><span class="kw">cv_model</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;Survived&quot;</span>, <span class="dt">nfolds =</span> <span class="dv">5</span>, <span class="dt">parallel =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; Computation done.</span>
pred &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">cv_predict</span>(<span class="dt">df =</span> xtest)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 0.7981181</span></code></pre></div>
<p><strong>Ridge Logistic Regression</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lf &lt;-<span class="st"> </span>LMTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="dt">alpha=</span><span class="dv">0</span>)
lf<span class="op">$</span><span class="kw">cv_model</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;Survived&quot;</span>, <span class="dt">nfolds =</span> <span class="dv">5</span>, <span class="dt">parallel =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; Computation done.</span>
pred &lt;-<span class="st"> </span>lf<span class="op">$</span><span class="kw">cv_predict</span>(<span class="dt">df =</span> xtest)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 0.7937464</span></code></pre></div>
<p><strong>Random Forest</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rf &lt;-<span class="st"> </span>RFTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">n_estimators =</span> <span class="dv">500</span>,<span class="dt">classification =</span> <span class="dv">1</span>, <span class="dt">max_features =</span> <span class="dv">3</span>)
rf<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;Survived&quot;</span>)

pred &lt;-<span class="st"> </span>rf<span class="op">$</span><span class="kw">predict</span>(<span class="dt">df =</span> xtest)
rf<span class="op">$</span><span class="kw">get_importance</span>()
<span class="co">#&gt;          tmp.order.tmp..decreasing...TRUE..</span>
<span class="co">#&gt; Sex                               83.179331</span>
<span class="co">#&gt; Fare                              49.530245</span>
<span class="co">#&gt; Age                               44.026986</span>
<span class="co">#&gt; Cabin                             27.806777</span>
<span class="co">#&gt; Pclass                            22.210427</span>
<span class="co">#&gt; SibSp                             13.742906</span>
<span class="co">#&gt; Parch                              9.837351</span>
<span class="co">#&gt; Embarked                           6.777296</span>

<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 0.7512739</span></code></pre></div>
<p><strong>Xgboost</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xgb &lt;-<span class="st"> </span>XGBTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>
                      , <span class="dt">n_estimators =</span> <span class="dv">500</span>
                      , <span class="dt">eval_metric =</span> <span class="st">&quot;auc&quot;</span>
                      , <span class="dt">maximize =</span> T
                      , <span class="dt">learning_rate =</span> <span class="fl">0.1</span>
                      ,<span class="dt">max_depth =</span> <span class="dv">6</span>)
xgb<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;Survived&quot;</span>, <span class="dt">valid =</span> xtest)
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-auc:0.910654  val-auc:0.815229 </span>
<span class="co">#&gt; [51] train-auc:0.977882  val-auc:0.803243 </span>
<span class="co">#&gt; [101]    train-auc:0.990142  val-auc:0.808280 </span>
<span class="co">#&gt; [151]    train-auc:0.994508  val-auc:0.807354 </span>
<span class="co">#&gt; [201]    train-auc:0.996520  val-auc:0.809352 </span>
<span class="co">#&gt; [251]    train-auc:0.997454  val-auc:0.809496 </span>
<span class="co">#&gt; [301]    train-auc:0.998147  val-auc:0.808309 </span>
<span class="co">#&gt; [351]    train-auc:0.998554  val-auc:0.808136 </span>
<span class="co">#&gt; [401]    train-auc:0.998796  val-auc:0.809120 </span>
<span class="co">#&gt; [451]    train-auc:0.999060  val-auc:0.809699 </span>
<span class="co">#&gt; [500]    train-auc:0.999104  val-auc:0.809699</span>

pred &lt;-<span class="st"> </span>xgb<span class="op">$</span><span class="kw">predict</span>(xtest)
<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 0.8096989</span></code></pre></div>
<p><strong>Grid Search</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xgb &lt;-<span class="st"> </span>XGBTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">objective=</span><span class="st">&quot;binary:logistic&quot;</span>)
gst &lt;-GridSearchCV<span class="op">$</span><span class="kw">new</span>(<span class="dt">trainer =</span> xgb,
                             <span class="dt">parameters =</span> <span class="kw">list</span>(<span class="dt">n_estimators =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>),
                             <span class="dt">max_depth =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),
                             <span class="dt">n_folds =</span> <span class="dv">3</span>,
                             <span class="dt">scoring =</span> <span class="kw">c</span>(<span class="st">'accuracy'</span>,<span class="st">'auc'</span>))
gst<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">&quot;Survived&quot;</span>)
<span class="co">#&gt; [1] &quot;entering grid search&quot;</span>
<span class="co">#&gt; [1] &quot;In total, 4 models will be trained&quot;</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.129808 </span>
<span class="co">#&gt; [10] train-error:0.098558</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.105769 </span>
<span class="co">#&gt; [10] train-error:0.088942</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.098558 </span>
<span class="co">#&gt; [10] train-error:0.069712</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.129808 </span>
<span class="co">#&gt; [50] train-error:0.038462</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.105769 </span>
<span class="co">#&gt; [50] train-error:0.036058</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.098558 </span>
<span class="co">#&gt; [50] train-error:0.036058</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.177885 </span>
<span class="co">#&gt; [10] train-error:0.153846</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.201923 </span>
<span class="co">#&gt; [10] train-error:0.137019</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.182692 </span>
<span class="co">#&gt; [10] train-error:0.115385</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.177885 </span>
<span class="co">#&gt; [50] train-error:0.110577</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.201923 </span>
<span class="co">#&gt; [50] train-error:0.096154</span>
<span class="co">#&gt; converting the data into xgboost format..</span>
<span class="co">#&gt; starting with training...</span>
<span class="co">#&gt; [1]  train-error:0.182692 </span>
<span class="co">#&gt; [50] train-error:0.081731</span>
gst<span class="op">$</span><span class="kw">best_iteration</span>()
<span class="co">#&gt; $n_estimators</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_depth</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_avg</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_sd</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_avg</span>
<span class="co">#&gt; [1] 0.883034</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_sd</span>
<span class="co">#&gt; [1] 0.0242347</span></code></pre></div>
<p><strong>Random Search</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rf &lt;-<span class="st"> </span>RFTrainer<span class="op">$</span><span class="kw">new</span>()
rst &lt;-RandomSearchCV<span class="op">$</span><span class="kw">new</span>(<span class="dt">trainer =</span> rf,
                             <span class="dt">parameters =</span> <span class="kw">list</span>(<span class="dt">n_estimators =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>),
                             <span class="dt">max_depth =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),
                             <span class="dt">n_folds =</span> <span class="dv">3</span>,
                             <span class="dt">scoring =</span> <span class="kw">c</span>(<span class="st">'accuracy'</span>,<span class="st">'auc'</span>),
                             <span class="dt">n_iter =</span> <span class="dv">3</span>)
rst<span class="op">$</span><span class="kw">fit</span>(xtrain, <span class="st">&quot;Survived&quot;</span>)
<span class="co">#&gt; [1] &quot;In total, 3 models will be trained&quot;</span>
rst<span class="op">$</span><span class="kw">best_iteration</span>()
<span class="co">#&gt; $n_estimators</span>
<span class="co">#&gt; [1] 50</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_depth</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_avg</span>
<span class="co">#&gt; [1] 0.849359</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $accuracy_sd</span>
<span class="co">#&gt; [1] 0.0264787</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_avg</span>
<span class="co">#&gt; [1] 0.8279856</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $auc_sd</span>
<span class="co">#&gt; [1] 0.02242134</span></code></pre></div>
<p>Let’s create some new feature based on target variable using target encoding and test a model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add target encoding features</span>
xtrain[, feat_<span class="dv">01</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">smoothMean</span>(<span class="dt">train_df =</span> xtrain,
                        <span class="dt">test_df =</span> xtest,
                        <span class="dt">colname =</span> <span class="st">&quot;Embarked&quot;</span>,
                        <span class="dt">target =</span> <span class="st">&quot;Survived&quot;</span>)<span class="op">$</span>train[[<span class="dv">2</span>]]]
xtest[, feat_<span class="dv">01</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">smoothMean</span>(<span class="dt">train_df =</span> xtrain,
                               <span class="dt">test_df =</span> xtest,
                               <span class="dt">colname =</span> <span class="st">&quot;Embarked&quot;</span>,
                               <span class="dt">target =</span> <span class="st">&quot;Survived&quot;</span>)<span class="op">$</span>test[[<span class="dv">2</span>]]]

<span class="co"># train a random forest</span>
<span class="co"># Random Forest</span>
rf &lt;-<span class="st"> </span>RFTrainer<span class="op">$</span><span class="kw">new</span>(<span class="dt">n_estimators =</span> <span class="dv">500</span>,<span class="dt">classification =</span> <span class="dv">1</span>, <span class="dt">max_features =</span> <span class="dv">4</span>)
rf<span class="op">$</span><span class="kw">fit</span>(<span class="dt">X =</span> xtrain, <span class="dt">y =</span> <span class="st">&quot;Survived&quot;</span>)
pred &lt;-<span class="st"> </span>rf<span class="op">$</span><span class="kw">predict</span>(<span class="dt">df =</span> xtest)
rf<span class="op">$</span><span class="kw">get_importance</span>()
<span class="co">#&gt;          tmp.order.tmp..decreasing...TRUE..</span>
<span class="co">#&gt; Sex                               85.213569</span>
<span class="co">#&gt; Fare                              51.676287</span>
<span class="co">#&gt; Age                               47.071256</span>
<span class="co">#&gt; Cabin                             28.804936</span>
<span class="co">#&gt; Pclass                            22.431287</span>
<span class="co">#&gt; SibSp                             13.735815</span>
<span class="co">#&gt; Parch                              9.643044</span>
<span class="co">#&gt; feat_01                            4.449812</span>
<span class="co">#&gt; Embarked                           4.385365</span>

<span class="kw">auc</span>(<span class="dt">actual =</span> xtest<span class="op">$</span>Survived, <span class="dt">predicted =</span> pred)
<span class="co">#&gt; [1] 0.7512739</span></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
