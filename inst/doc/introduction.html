<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Manish Saraswat" />

<meta name="date" content="2024-02-18" />

<title>Introduction to SuperML</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SuperML</h1>
<h4 class="author">Manish Saraswat</h4>
<h4 class="date">2024-02-18</h4>



<p>SuperML R package is designed to unify the model training process in
R like Python. Generally, it’s seen that people spend lot of time in
searching for packages, figuring out the syntax for training machine
learning models in R. This behaviour is highly apparent in users who
frequently switch between R and Python. This package provides a python´s
scikit-learn interface (<code>fit</code>, <code>predict</code>) to train
models faster.</p>
<p>In addition to building machine learning models, there are handy
functionalities to do feature engineering</p>
<p>This ambitious package is my ongoing effort to help the r-community
build ML models easily and faster in R.</p>
<div id="install" class="section level2">
<h2>Install</h2>
<p>You can install latest cran version using (recommended):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;superml&quot;</span>)</span></code></pre></div>
<p>You can install the developmemt version directly from github
using:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;saraswatmks/superml&quot;</span>)</span></code></pre></div>
</div>
<div id="caveats-on-superml-installation" class="section level2">
<h2>Caveats on superml installation</h2>
<p>For machine learning, superml is based on the existing R packages.
Hence, while installing the package, we don’t install all the
dependencies. However, while training any model, superml will
automatically install the package if its not found. Still, if you want
to install all dependencies at once, you can simply do:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;superml&quot;</span>, <span class="at">dependencies=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="examples---machine-learning-models" class="section level2">
<h2>Examples - Machine Learning Models</h2>
<p>This package uses existing r-packages to build machine learning
model. In this tutorial, we’ll use data.table R package to do all tasks
related to data manipulation.</p>
<div id="regression-data" class="section level3">
<h3>Regression Data</h3>
<p>We’ll quickly prepare the data set to be ready to served for model
training.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;../data/reg_train.rda&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># if the above doesn&#39;t work, you can try: load(&quot;reg_train.rda&quot;)</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># superml::check_package(&quot;caret&quot;)</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; Loading required package: lattice</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">library</span>(superml)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;Metrics&#39;</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:caret&#39;:</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt;     precision, recall</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="fu">head</span>(reg_train)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;    Id MSSubClass MSZoning LotFrontage LotArea Street Alley LotShape LandContour</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; 1:  1         60       RL          65    8450   Pave  &lt;NA&gt;      Reg         Lvl</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; 2:  2         20       RL          80    9600   Pave  &lt;NA&gt;      Reg         Lvl</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; 3:  3         60       RL          68   11250   Pave  &lt;NA&gt;      IR1         Lvl</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; 4:  4         70       RL          60    9550   Pave  &lt;NA&gt;      IR1         Lvl</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; 5:  5         60       RL          84   14260   Pave  &lt;NA&gt;      IR1         Lvl</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; 6:  6         50       RL          85   14115   Pave  &lt;NA&gt;      IR1         Lvl</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;    Utilities LotConfig LandSlope Neighborhood Condition1 Condition2 BldgType</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; 1:    AllPub    Inside       Gtl      CollgCr       Norm       Norm     1Fam</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; 2:    AllPub       FR2       Gtl      Veenker      Feedr       Norm     1Fam</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; 3:    AllPub    Inside       Gtl      CollgCr       Norm       Norm     1Fam</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; 4:    AllPub    Corner       Gtl      Crawfor       Norm       Norm     1Fam</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; 5:    AllPub       FR2       Gtl      NoRidge       Norm       Norm     1Fam</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; 6:    AllPub    Inside       Gtl      Mitchel       Norm       Norm     1Fam</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt;    HouseStyle OverallQual OverallCond YearBuilt YearRemodAdd RoofStyle RoofMatl</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; 1:     2Story           7           5      2003         2003     Gable  CompShg</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt; 2:     1Story           6           8      1976         1976     Gable  CompShg</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt; 3:     2Story           7           5      2001         2002     Gable  CompShg</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co">#&gt; 4:     2Story           7           5      1915         1970     Gable  CompShg</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co">#&gt; 5:     2Story           8           5      2000         2000     Gable  CompShg</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co">#&gt; 6:     1.5Fin           5           5      1993         1995     Gable  CompShg</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co">#&gt;    Exterior1st Exterior2nd MasVnrType MasVnrArea ExterQual ExterCond Foundation</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co">#&gt; 1:     VinylSd     VinylSd    BrkFace        196        Gd        TA      PConc</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="co">#&gt; 2:     MetalSd     MetalSd       None          0        TA        TA     CBlock</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="co">#&gt; 3:     VinylSd     VinylSd    BrkFace        162        Gd        TA      PConc</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="co">#&gt; 4:     Wd Sdng     Wd Shng       None          0        TA        TA     BrkTil</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="co">#&gt; 5:     VinylSd     VinylSd    BrkFace        350        Gd        TA      PConc</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="co">#&gt; 6:     VinylSd     VinylSd       None          0        TA        TA       Wood</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="co">#&gt;    BsmtQual BsmtCond BsmtExposure BsmtFinType1 BsmtFinSF1 BsmtFinType2</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="co">#&gt; 1:       Gd       TA           No          GLQ        706          Unf</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a><span class="co">#&gt; 2:       Gd       TA           Gd          ALQ        978          Unf</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a><span class="co">#&gt; 3:       Gd       TA           Mn          GLQ        486          Unf</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a><span class="co">#&gt; 4:       TA       Gd           No          ALQ        216          Unf</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a><span class="co">#&gt; 5:       Gd       TA           Av          GLQ        655          Unf</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a><span class="co">#&gt; 6:       Gd       TA           No          GLQ        732          Unf</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a><span class="co">#&gt;    BsmtFinSF2 BsmtUnfSF TotalBsmtSF Heating HeatingQC CentralAir Electrical</span></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a><span class="co">#&gt; 1:          0       150         856    GasA        Ex          Y      SBrkr</span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="co">#&gt; 2:          0       284        1262    GasA        Ex          Y      SBrkr</span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a><span class="co">#&gt; 3:          0       434         920    GasA        Ex          Y      SBrkr</span></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a><span class="co">#&gt; 4:          0       540         756    GasA        Gd          Y      SBrkr</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a><span class="co">#&gt; 5:          0       490        1145    GasA        Ex          Y      SBrkr</span></span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a><span class="co">#&gt; 6:          0        64         796    GasA        Ex          Y      SBrkr</span></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a><span class="co">#&gt;    1stFlrSF 2ndFlrSF LowQualFinSF GrLivArea BsmtFullBath BsmtHalfBath FullBath</span></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a><span class="co">#&gt; 1:      856      854            0      1710            1            0        2</span></span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a><span class="co">#&gt; 2:     1262        0            0      1262            0            1        2</span></span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a><span class="co">#&gt; 3:      920      866            0      1786            1            0        2</span></span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a><span class="co">#&gt; 4:      961      756            0      1717            1            0        1</span></span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a><span class="co">#&gt; 5:     1145     1053            0      2198            1            0        2</span></span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a><span class="co">#&gt; 6:      796      566            0      1362            1            0        1</span></span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a><span class="co">#&gt;    HalfBath BedroomAbvGr KitchenAbvGr KitchenQual TotRmsAbvGrd Functional</span></span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a><span class="co">#&gt; 1:        1            3            1          Gd            8        Typ</span></span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a><span class="co">#&gt; 2:        0            3            1          TA            6        Typ</span></span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a><span class="co">#&gt; 3:        1            3            1          Gd            6        Typ</span></span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a><span class="co">#&gt; 4:        0            3            1          Gd            7        Typ</span></span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a><span class="co">#&gt; 5:        1            4            1          Gd            9        Typ</span></span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a><span class="co">#&gt; 6:        1            1            1          TA            5        Typ</span></span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a><span class="co">#&gt;    Fireplaces FireplaceQu GarageType GarageYrBlt GarageFinish GarageCars</span></span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a><span class="co">#&gt; 1:          0        &lt;NA&gt;     Attchd        2003          RFn          2</span></span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a><span class="co">#&gt; 2:          1          TA     Attchd        1976          RFn          2</span></span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a><span class="co">#&gt; 3:          1          TA     Attchd        2001          RFn          2</span></span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a><span class="co">#&gt; 4:          1          Gd     Detchd        1998          Unf          3</span></span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a><span class="co">#&gt; 5:          1          TA     Attchd        2000          RFn          3</span></span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a><span class="co">#&gt; 6:          0        &lt;NA&gt;     Attchd        1993          Unf          2</span></span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a><span class="co">#&gt;    GarageArea GarageQual GarageCond PavedDrive WoodDeckSF OpenPorchSF</span></span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a><span class="co">#&gt; 1:        548         TA         TA          Y          0          61</span></span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a><span class="co">#&gt; 2:        460         TA         TA          Y        298           0</span></span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a><span class="co">#&gt; 3:        608         TA         TA          Y          0          42</span></span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a><span class="co">#&gt; 4:        642         TA         TA          Y          0          35</span></span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a><span class="co">#&gt; 5:        836         TA         TA          Y        192          84</span></span>
<span id="cb4-87"><a href="#cb4-87" tabindex="-1"></a><span class="co">#&gt; 6:        480         TA         TA          Y         40          30</span></span>
<span id="cb4-88"><a href="#cb4-88" tabindex="-1"></a><span class="co">#&gt;    EnclosedPorch 3SsnPorch ScreenPorch PoolArea PoolQC Fence MiscFeature</span></span>
<span id="cb4-89"><a href="#cb4-89" tabindex="-1"></a><span class="co">#&gt; 1:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span></span>
<span id="cb4-90"><a href="#cb4-90" tabindex="-1"></a><span class="co">#&gt; 2:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span></span>
<span id="cb4-91"><a href="#cb4-91" tabindex="-1"></a><span class="co">#&gt; 3:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span></span>
<span id="cb4-92"><a href="#cb4-92" tabindex="-1"></a><span class="co">#&gt; 4:           272         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span></span>
<span id="cb4-93"><a href="#cb4-93" tabindex="-1"></a><span class="co">#&gt; 5:             0         0           0        0   &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt;</span></span>
<span id="cb4-94"><a href="#cb4-94" tabindex="-1"></a><span class="co">#&gt; 6:             0       320           0        0   &lt;NA&gt; MnPrv        Shed</span></span>
<span id="cb4-95"><a href="#cb4-95" tabindex="-1"></a><span class="co">#&gt;    MiscVal MoSold YrSold SaleType SaleCondition SalePrice</span></span>
<span id="cb4-96"><a href="#cb4-96" tabindex="-1"></a><span class="co">#&gt; 1:       0      2   2008       WD        Normal    208500</span></span>
<span id="cb4-97"><a href="#cb4-97" tabindex="-1"></a><span class="co">#&gt; 2:       0      5   2007       WD        Normal    181500</span></span>
<span id="cb4-98"><a href="#cb4-98" tabindex="-1"></a><span class="co">#&gt; 3:       0      9   2008       WD        Normal    223500</span></span>
<span id="cb4-99"><a href="#cb4-99" tabindex="-1"></a><span class="co">#&gt; 4:       0      2   2006       WD       Abnorml    140000</span></span>
<span id="cb4-100"><a href="#cb4-100" tabindex="-1"></a><span class="co">#&gt; 5:       0     12   2008       WD        Normal    250000</span></span>
<span id="cb4-101"><a href="#cb4-101" tabindex="-1"></a><span class="co">#&gt; 6:     700     10   2009       WD        Normal    143000</span></span>
<span id="cb4-102"><a href="#cb4-102" tabindex="-1"></a></span>
<span id="cb4-103"><a href="#cb4-103" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> reg_train<span class="sc">$</span>SalePrice, <span class="at">p =</span> <span class="fl">0.7</span>)</span>
<span id="cb4-104"><a href="#cb4-104" tabindex="-1"></a>xtrain <span class="ot">&lt;-</span> reg_train[split<span class="sc">$</span>Resample1]</span>
<span id="cb4-105"><a href="#cb4-105" tabindex="-1"></a>xtest <span class="ot">&lt;-</span> reg_train[<span class="sc">!</span>split<span class="sc">$</span>Resample1]</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># remove features with 90% or more missing values</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># we will also remove the Id column because it doesn&#39;t contain</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># any useful information</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>na_cols <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(xtrain)) <span class="sc">/</span> <span class="fu">nrow</span>(xtrain)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>na_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(na_cols[<span class="fu">which</span>(na_cols <span class="sc">&gt;</span> <span class="fl">0.9</span>)])</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>xtrain[, <span class="fu">c</span>(na_cols, <span class="st">&quot;Id&quot;</span>) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>xtest[, <span class="fu">c</span>(na_cols, <span class="st">&quot;Id&quot;</span>) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># encode categorical variables</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>cat_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(xtrain)[<span class="fu">sapply</span>(xtrain, is.character)]</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="cf">for</span>(c <span class="cf">in</span> cat_cols){</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    lbl <span class="ot">&lt;-</span> LabelEncoder<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    lbl<span class="sc">$</span><span class="fu">fit</span>(<span class="fu">c</span>(xtrain[[c]], xtest[[c]]))</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>    xtrain[[c]] <span class="ot">&lt;-</span> lbl<span class="sc">$</span><span class="fu">transform</span>(xtrain[[c]])</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    xtest[[c]] <span class="ot">&lt;-</span> lbl<span class="sc">$</span><span class="fu">transform</span>(xtest[[c]])</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39; </span></span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a><span class="co">#&gt; The data contains NA values. Imputing NA with &#39;NA&#39;</span></span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a></span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a><span class="co"># removing noise column</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;GrLivArea&#39;</span>,<span class="st">&#39;TotalBsmtSF&#39;</span>)</span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a>xtrain[, <span class="fu">c</span>(noise) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a>xtest[, <span class="fu">c</span>(noise) <span class="sc">:=</span> <span class="cn">NULL</span>]</span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a><span class="co"># fill missing value with  -1</span></span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a>xtrain[<span class="fu">is.na</span>(xtrain)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a>xtest[<span class="fu">is.na</span>(xtest)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span></code></pre></div>
<p><strong>KNN Regression</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>knn <span class="ot">&lt;-</span> KNNTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">k =</span> <span class="dv">2</span>,<span class="at">prob =</span> T,<span class="at">type =</span> <span class="st">&#39;reg&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>knn<span class="sc">$</span><span class="fu">fit</span>(<span class="at">train =</span> xtrain, <span class="at">test =</span> xtest, <span class="at">y =</span> <span class="st">&#39;SalePrice&#39;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>probs <span class="ot">&lt;-</span> knn<span class="sc">$</span><span class="fu">predict</span>(<span class="at">type =</span> <span class="st">&#39;prob&#39;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>labels <span class="ot">&lt;-</span> knn<span class="sc">$</span><span class="fu">predict</span>(<span class="at">type=</span><span class="st">&#39;raw&#39;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted=</span>labels)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; [1] 50619.75</span></span></code></pre></div>
<p><strong>SVM Regression</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>svm <span class="ot">&lt;-</span> SVMTrainer<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>svm<span class="sc">$</span><span class="fu">fit</span>(xtrain, <span class="st">&#39;SalePrice&#39;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> svm<span class="sc">$</span><span class="fu">predict</span>(xtest)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted =</span> pred)</span></code></pre></div>
<p><strong>Simple Regresison</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>lf <span class="ot">&lt;-</span> LMTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>lf<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;SalePrice&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">summary</span>(lf<span class="sc">$</span>model)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; stats::glm(formula = f, family = self$family, data = X, weights = self$weights)</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Coefficients: (1 not defined because of singularities)</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)    1.296e+06  1.605e+06   0.807 0.419765    </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; MSSubClass    -1.596e+02  4.528e+01  -3.524 0.000445 ***</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; MSZoning      -2.418e+03  1.744e+03  -1.387 0.165864    </span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; LotFrontage   -5.934e+01  3.400e+01  -1.745 0.081257 .  </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; LotArea        4.490e-01  1.366e-01   3.287 0.001051 ** </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; Street        -4.059e+04  2.088e+04  -1.944 0.052238 .  </span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; LotShape       8.265e+01  2.098e+03   0.039 0.968591    </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; LandContour   -1.059e+03  2.272e+03  -0.466 0.641316    </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; Utilities             NA         NA      NA       NA    </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; LotConfig      1.520e+03  1.092e+03   1.392 0.164303    </span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; LandSlope      1.006e+04  5.030e+03   2.001 0.045718 *  </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; Neighborhood   5.015e+02  1.987e+02   2.524 0.011761 *  </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; Condition1    -1.763e+03  9.432e+02  -1.870 0.061859 .  </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; Condition2    -9.393e+03  2.832e+03  -3.317 0.000944 ***</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; BldgType      -6.226e+02  1.974e+03  -0.315 0.752598    </span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; HouseStyle     1.973e+02  8.855e+02   0.223 0.823775    </span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; OverallQual    1.680e+04  1.364e+03  12.316  &lt; 2e-16 ***</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; OverallCond    5.159e+03  1.225e+03   4.211 2.79e-05 ***</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; YearBuilt      2.392e+02  8.954e+01   2.672 0.007678 ** </span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; YearRemodAdd   1.355e+02  8.129e+01   1.667 0.095914 .  </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; RoofStyle      5.727e+03  1.921e+03   2.981 0.002945 ** </span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; RoofMatl      -1.288e+04  2.533e+03  -5.083 4.47e-07 ***</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; Exterior1st   -1.895e+03  6.889e+02  -2.750 0.006069 ** </span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; Exterior2nd    1.246e+03  6.551e+02   1.902 0.057430 .  </span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; MasVnrType     3.984e+03  1.695e+03   2.350 0.018986 *  </span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; MasVnrArea     3.162e+01  7.220e+00   4.379 1.32e-05 ***</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt; ExterQual      2.974e+03  2.364e+03   1.258 0.208725    </span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt; ExterCond      2.453e+03  2.420e+03   1.014 0.310879    </span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt; Foundation    -2.473e+03  1.525e+03  -1.622 0.105184    </span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt; BsmtQual       1.493e+03  1.488e+03   1.004 0.315833    </span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="co">#&gt; BsmtCond      -4.395e+02  1.453e+03  -0.302 0.762416    </span></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt; BsmtExposure   2.758e+03  9.849e+02   2.800 0.005211 ** </span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt; BsmtFinType1  -1.829e+03  8.187e+02  -2.235 0.025668 *  </span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt; BsmtFinSF1     7.017e+00  6.055e+00   1.159 0.246795    </span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt; BsmtFinType2  -1.110e+03  1.219e+03  -0.911 0.362676    </span></span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a><span class="co">#&gt; BsmtFinSF2     1.368e+01  9.628e+00   1.421 0.155567    </span></span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a><span class="co">#&gt; BsmtUnfSF      1.118e+00  5.842e+00   0.191 0.848287    </span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co">#&gt; Heating       -1.301e+03  3.584e+03  -0.363 0.716799    </span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a><span class="co">#&gt; HeatingQC     -2.912e+03  1.404e+03  -2.074 0.038313 *  </span></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a><span class="co">#&gt; CentralAir     5.515e+03  5.488e+03   1.005 0.315212    </span></span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a><span class="co">#&gt; Electrical     1.643e+03  1.523e+03   1.079 0.280997    </span></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co">#&gt; `1stFlrSF`     3.679e+01  7.274e+00   5.058 5.09e-07 ***</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a><span class="co">#&gt; `2ndFlrSF`     3.062e+01  6.024e+00   5.083 4.47e-07 ***</span></span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a><span class="co">#&gt; LowQualFinSF   2.060e+01  2.313e+01   0.891 0.373282    </span></span>
<span id="cb8-54"><a href="#cb8-54" tabindex="-1"></a><span class="co">#&gt; BsmtFullBath   1.058e+04  3.048e+03   3.470 0.000544 ***</span></span>
<span id="cb8-55"><a href="#cb8-55" tabindex="-1"></a><span class="co">#&gt; BsmtHalfBath  -1.596e+03  4.871e+03  -0.328 0.743172    </span></span>
<span id="cb8-56"><a href="#cb8-56" tabindex="-1"></a><span class="co">#&gt; FullBath       9.015e+03  3.216e+03   2.804 0.005156 ** </span></span>
<span id="cb8-57"><a href="#cb8-57" tabindex="-1"></a><span class="co">#&gt; HalfBath       3.567e+03  2.997e+03   1.190 0.234208    </span></span>
<span id="cb8-58"><a href="#cb8-58" tabindex="-1"></a><span class="co">#&gt; BedroomAbvGr  -5.661e+03  1.943e+03  -2.913 0.003666 ** </span></span>
<span id="cb8-59"><a href="#cb8-59" tabindex="-1"></a><span class="co">#&gt; KitchenAbvGr  -1.355e+04  6.414e+03  -2.112 0.034914 *  </span></span>
<span id="cb8-60"><a href="#cb8-60" tabindex="-1"></a><span class="co">#&gt; KitchenQual    6.223e+03  1.796e+03   3.465 0.000554 ***</span></span>
<span id="cb8-61"><a href="#cb8-61" tabindex="-1"></a><span class="co">#&gt; TotRmsAbvGrd   5.676e+03  1.455e+03   3.902 0.000102 ***</span></span>
<span id="cb8-62"><a href="#cb8-62" tabindex="-1"></a><span class="co">#&gt; Functional    -4.137e+03  1.583e+03  -2.614 0.009080 ** </span></span>
<span id="cb8-63"><a href="#cb8-63" tabindex="-1"></a><span class="co">#&gt; Fireplaces    -1.663e+02  2.554e+03  -0.065 0.948105    </span></span>
<span id="cb8-64"><a href="#cb8-64" tabindex="-1"></a><span class="co">#&gt; FireplaceQu    4.029e+03  1.404e+03   2.870 0.004191 ** </span></span>
<span id="cb8-65"><a href="#cb8-65" tabindex="-1"></a><span class="co">#&gt; GarageType     1.664e+02  1.380e+03   0.121 0.904026    </span></span>
<span id="cb8-66"><a href="#cb8-66" tabindex="-1"></a><span class="co">#&gt; GarageYrBlt    1.581e+00  5.738e+00   0.276 0.782978    </span></span>
<span id="cb8-67"><a href="#cb8-67" tabindex="-1"></a><span class="co">#&gt; GarageFinish  -1.441e+01  1.525e+03  -0.009 0.992463    </span></span>
<span id="cb8-68"><a href="#cb8-68" tabindex="-1"></a><span class="co">#&gt; GarageCars     1.323e+04  3.501e+03   3.780 0.000167 ***</span></span>
<span id="cb8-69"><a href="#cb8-69" tabindex="-1"></a><span class="co">#&gt; GarageArea     1.683e+01  1.183e+01   1.423 0.155049    </span></span>
<span id="cb8-70"><a href="#cb8-70" tabindex="-1"></a><span class="co">#&gt; GarageQual     8.273e+03  3.293e+03   2.513 0.012149 *  </span></span>
<span id="cb8-71"><a href="#cb8-71" tabindex="-1"></a><span class="co">#&gt; GarageCond    -1.480e+03  2.165e+03  -0.684 0.494158    </span></span>
<span id="cb8-72"><a href="#cb8-72" tabindex="-1"></a><span class="co">#&gt; PavedDrive    -2.902e+03  3.090e+03  -0.939 0.347968    </span></span>
<span id="cb8-73"><a href="#cb8-73" tabindex="-1"></a><span class="co">#&gt; WoodDeckSF     2.260e+01  9.139e+00   2.473 0.013569 *  </span></span>
<span id="cb8-74"><a href="#cb8-74" tabindex="-1"></a><span class="co">#&gt; OpenPorchSF    2.219e+01  1.829e+01   1.213 0.225405    </span></span>
<span id="cb8-75"><a href="#cb8-75" tabindex="-1"></a><span class="co">#&gt; EnclosedPorch  2.817e+01  1.862e+01   1.513 0.130725    </span></span>
<span id="cb8-76"><a href="#cb8-76" tabindex="-1"></a><span class="co">#&gt; `3SsnPorch`    5.053e+01  3.686e+01   1.371 0.170751    </span></span>
<span id="cb8-77"><a href="#cb8-77" tabindex="-1"></a><span class="co">#&gt; ScreenPorch    8.503e+01  2.091e+01   4.067 5.15e-05 ***</span></span>
<span id="cb8-78"><a href="#cb8-78" tabindex="-1"></a><span class="co">#&gt; PoolArea      -8.682e+01  2.844e+01  -3.052 0.002334 ** </span></span>
<span id="cb8-79"><a href="#cb8-79" tabindex="-1"></a><span class="co">#&gt; Fence         -9.121e+02  1.421e+03  -0.642 0.520980    </span></span>
<span id="cb8-80"><a href="#cb8-80" tabindex="-1"></a><span class="co">#&gt; MiscVal        2.612e-01  1.844e+00   0.142 0.887346    </span></span>
<span id="cb8-81"><a href="#cb8-81" tabindex="-1"></a><span class="co">#&gt; MoSold        -2.057e+02  3.821e+02  -0.538 0.590532    </span></span>
<span id="cb8-82"><a href="#cb8-82" tabindex="-1"></a><span class="co">#&gt; YrSold        -1.056e+03  7.972e+02  -1.324 0.185735    </span></span>
<span id="cb8-83"><a href="#cb8-83" tabindex="-1"></a><span class="co">#&gt; SaleType       3.283e+03  1.351e+03   2.431 0.015250 *  </span></span>
<span id="cb8-84"><a href="#cb8-84" tabindex="-1"></a><span class="co">#&gt; SaleCondition  1.627e+03  1.265e+03   1.286 0.198766    </span></span>
<span id="cb8-85"><a href="#cb8-85" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb8-86"><a href="#cb8-86" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-87"><a href="#cb8-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-88"><a href="#cb8-88" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1025713223)</span></span>
<span id="cb8-89"><a href="#cb8-89" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-90"><a href="#cb8-90" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 6.2770e+12  on 1023  degrees of freedom</span></span>
<span id="cb8-91"><a href="#cb8-91" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 9.7443e+11  on  950  degrees of freedom</span></span>
<span id="cb8-92"><a href="#cb8-92" tabindex="-1"></a><span class="co">#&gt; AIC: 24226</span></span>
<span id="cb8-93"><a href="#cb8-93" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-94"><a href="#cb8-94" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb8-95"><a href="#cb8-95" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb8-96"><a href="#cb8-96" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted =</span> predictions)</span>
<span id="cb8-97"><a href="#cb8-97" tabindex="-1"></a><span class="co">#&gt; [1] 36414.68</span></span></code></pre></div>
<p><strong>Lasso Regression</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>lf <span class="ot">&lt;-</span> LMTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="dv">1000</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>lf<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;SalePrice&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted =</span> predictions)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; [1] 40647.6</span></span></code></pre></div>
<p><strong>Ridge Regression</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>lf <span class="ot">&lt;-</span> LMTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>lf<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;SalePrice&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted =</span> predictions)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; [1] 41033.56</span></span></code></pre></div>
<p><strong>Logistic Regression with CV</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>lf <span class="ot">&lt;-</span> LMTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>lf<span class="sc">$</span><span class="fu">cv_model</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&#39;SalePrice&#39;</span>, <span class="at">nfolds =</span> <span class="dv">5</span>, <span class="at">parallel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">cv_predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">get_importance</span>()</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted =</span> predictions)</span></code></pre></div>
<p><strong>Random Forest</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>rf <span class="ot">&lt;-</span> RFTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">n_estimators =</span> <span class="dv">500</span>,<span class="at">classification =</span> <span class="dv">0</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>rf<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;SalePrice&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> rf<span class="sc">$</span><span class="fu">predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>rf<span class="sc">$</span><span class="fu">get_importance</span>()</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt;               tmp.order.tmp..decreasing...TRUE..</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; OverallQual                         805396946851</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; GarageCars                          522277512570</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; GarageArea                          492504056036</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; 1stFlrSF                            456146530362</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; YearBuilt                           321001356223</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; FullBath                            273711059272</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; BsmtFinSF1                          256640207793</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; GarageYrBlt                         242955028927</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; BsmtQual                            221599078735</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; TotRmsAbvGrd                        197896142442</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; LotArea                             187832123674</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; ExterQual                           172679747974</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; 2ndFlrSF                            165575198771</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; YearRemodAdd                        153466157731</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; FireplaceQu                         138693929431</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; MasVnrArea                          128673493393</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; KitchenQual                         117443303312</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; Fireplaces                          111705942290</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; OpenPorchSF                          92631484839</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; Foundation                           83286121952</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; LotFrontage                          78827754312</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; BsmtUnfSF                            65668598298</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; BsmtFinType1                         61625988292</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; WoodDeckSF                           57948560794</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; Neighborhood                         57616557231</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; HeatingQC                            47085794011</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt; BedroomAbvGr                         44560418156</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; GarageType                           41061811034</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; MSSubClass                           38186219440</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; OverallCond                          32843017602</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt; Exterior2nd                          32477077925</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt; HalfBath                             31853557276</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; MoSold                               31439094626</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; Exterior1st                          27829430593</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; HouseStyle                           27529302283</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; YrSold                               26883223060</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a><span class="co">#&gt; RoofStyle                            26445458267</span></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co">#&gt; BsmtFullBath                         25895731346</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a><span class="co">#&gt; LotShape                             22357815068</span></span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a><span class="co">#&gt; BsmtExposure                         21438623304</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a><span class="co">#&gt; GarageFinish                         20395336117</span></span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a><span class="co">#&gt; MSZoning                             17500907349</span></span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a><span class="co">#&gt; SaleCondition                        17274027042</span></span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a><span class="co">#&gt; MasVnrType                           17169758549</span></span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a><span class="co">#&gt; ScreenPorch                          16281657555</span></span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a><span class="co">#&gt; GarageQual                           15715484041</span></span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a><span class="co">#&gt; LandContour                          15003410671</span></span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a><span class="co">#&gt; CentralAir                           14567933496</span></span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a><span class="co">#&gt; LotConfig                            14394740952</span></span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a><span class="co">#&gt; BldgType                             13477548912</span></span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a><span class="co">#&gt; GarageCond                           13395753051</span></span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a><span class="co">#&gt; SaleType                             13189102573</span></span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a><span class="co">#&gt; EnclosedPorch                        10687715135</span></span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a><span class="co">#&gt; BsmtFinSF2                           10438619040</span></span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a><span class="co">#&gt; Condition1                           10308218603</span></span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a><span class="co">#&gt; LandSlope                             9906284042</span></span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a><span class="co">#&gt; ExterCond                             8994393632</span></span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a><span class="co">#&gt; Functional                            7360746298</span></span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a><span class="co">#&gt; BsmtFinType2                          6937544624</span></span>
<span id="cb12-65"><a href="#cb12-65" tabindex="-1"></a><span class="co">#&gt; RoofMatl                              6765618719</span></span>
<span id="cb12-66"><a href="#cb12-66" tabindex="-1"></a><span class="co">#&gt; KitchenAbvGr                          6604190117</span></span>
<span id="cb12-67"><a href="#cb12-67" tabindex="-1"></a><span class="co">#&gt; BsmtCond                              6435711990</span></span>
<span id="cb12-68"><a href="#cb12-68" tabindex="-1"></a><span class="co">#&gt; Fence                                 6259391880</span></span>
<span id="cb12-69"><a href="#cb12-69" tabindex="-1"></a><span class="co">#&gt; LowQualFinSF                          5518554748</span></span>
<span id="cb12-70"><a href="#cb12-70" tabindex="-1"></a><span class="co">#&gt; PavedDrive                            4503508900</span></span>
<span id="cb12-71"><a href="#cb12-71" tabindex="-1"></a><span class="co">#&gt; Heating                               3676274614</span></span>
<span id="cb12-72"><a href="#cb12-72" tabindex="-1"></a><span class="co">#&gt; Condition2                            3363484182</span></span>
<span id="cb12-73"><a href="#cb12-73" tabindex="-1"></a><span class="co">#&gt; BsmtHalfBath                          2930090851</span></span>
<span id="cb12-74"><a href="#cb12-74" tabindex="-1"></a><span class="co">#&gt; Electrical                            2626782717</span></span>
<span id="cb12-75"><a href="#cb12-75" tabindex="-1"></a><span class="co">#&gt; 3SsnPorch                             2014013123</span></span>
<span id="cb12-76"><a href="#cb12-76" tabindex="-1"></a><span class="co">#&gt; MiscVal                               1804559185</span></span>
<span id="cb12-77"><a href="#cb12-77" tabindex="-1"></a><span class="co">#&gt; PoolArea                              1794636554</span></span>
<span id="cb12-78"><a href="#cb12-78" tabindex="-1"></a><span class="co">#&gt; Street                                 317976991</span></span>
<span id="cb12-79"><a href="#cb12-79" tabindex="-1"></a><span class="co">#&gt; Utilities                                      0</span></span>
<span id="cb12-80"><a href="#cb12-80" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted =</span> pred)</span>
<span id="cb12-81"><a href="#cb12-81" tabindex="-1"></a><span class="co">#&gt; [1] 33814.05</span></span></code></pre></div>
<p><strong>Xgboost</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>xgb <span class="ot">&lt;-</span> XGBTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">objective =</span> <span class="st">&quot;reg:linear&quot;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>                      , <span class="at">n_estimators =</span> <span class="dv">500</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                      , <span class="at">eval_metric =</span> <span class="st">&quot;rmse&quot;</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                      , <span class="at">maximize =</span> F</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                      , <span class="at">learning_rate =</span> <span class="fl">0.1</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                      ,<span class="at">max_depth =</span> <span class="dv">6</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>xgb<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;SalePrice&quot;</span>, <span class="at">valid =</span> xtest)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>pred <span class="ot">&lt;-</span> xgb<span class="sc">$</span><span class="fu">predict</span>(xtest)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="fu">rmse</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>SalePrice, <span class="at">predicted =</span> pred)</span></code></pre></div>
<p><strong>Grid Search</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>xgb <span class="ot">&lt;-</span> XGBTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">objective =</span> <span class="st">&quot;reg:linear&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>gst <span class="ot">&lt;-</span> GridSearchCV<span class="sc">$</span><span class="fu">new</span>(<span class="at">trainer =</span> xgb,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                             <span class="at">parameters =</span> <span class="fu">list</span>(<span class="at">n_estimators =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">50</span>), <span class="at">max_depth =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                             <span class="at">n_folds =</span> <span class="dv">3</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                             <span class="at">scoring =</span> <span class="fu">c</span>(<span class="st">&#39;accuracy&#39;</span>,<span class="st">&#39;auc&#39;</span>))</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>gst<span class="sc">$</span><span class="fu">fit</span>(xtrain, <span class="st">&quot;SalePrice&quot;</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>gst<span class="sc">$</span><span class="fu">best_iteration</span>()</span></code></pre></div>
<p><strong>Random Search</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>rf <span class="ot">&lt;-</span> RFTrainer<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>rst <span class="ot">&lt;-</span> RandomSearchCV<span class="sc">$</span><span class="fu">new</span>(<span class="at">trainer =</span> rf,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                             <span class="at">parameters =</span> <span class="fu">list</span>(<span class="at">n_estimators =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                             <span class="at">max_depth =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                             <span class="at">n_folds =</span> <span class="dv">3</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                             <span class="at">scoring =</span> <span class="fu">c</span>(<span class="st">&#39;accuracy&#39;</span>,<span class="st">&#39;auc&#39;</span>),</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                             <span class="at">n_iter =</span> <span class="dv">3</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>rst<span class="sc">$</span><span class="fu">fit</span>(xtrain, <span class="st">&quot;SalePrice&quot;</span>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;In total, 3 models will be trained&quot;</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>rst<span class="sc">$</span><span class="fu">best_iteration</span>()</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; $n_estimators</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; $max_depth</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; $accuracy_avg</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; [1] 0.005850878</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; $accuracy_sd</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; [1] 0.002902616</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; $auc_avg</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; [1] NaN</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; $auc_sd</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
</div>
<div id="binary-classification-data" class="section level3">
<h3>Binary Classification Data</h3>
<p>Here, we will solve a simple binary classification problem (predict
people who survived on titanic ship). The idea here is to demonstrate
how to use this package to solve classification problems.</p>
<p><strong>Data Preparation</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># load class</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;../data/cla_train.rda&#39;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co"># if the above doesn&#39;t work, you can try: load(&quot;cla_train.rda&quot;)</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">head</span>(cla_train)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt;    PassengerId Survived Pclass</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; 1:           1        0      3</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; 2:           2        1      1</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; 3:           3        1      3</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; 4:           4        1      1</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; 5:           5        0      3</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; 6:           6        0      3</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt;                                                   Name    Sex Age SibSp Parch</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; 1:                             Braund, Mr. Owen Harris   male  22     1     0</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; 2: Cumings, Mrs. John Bradley (Florence Briggs Thayer) female  38     1     0</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; 3:                              Heikkinen, Miss. Laina female  26     0     0</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; 4:        Futrelle, Mrs. Jacques Heath (Lily May Peel) female  35     1     0</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt; 5:                            Allen, Mr. William Henry   male  35     0     0</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt; 6:                                    Moran, Mr. James   male  NA     0     0</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt;              Ticket    Fare Cabin Embarked</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; 1:        A/5 21171  7.2500              S</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt; 2:         PC 17599 71.2833   C85        C</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; 3: STON/O2. 3101282  7.9250              S</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; 4:           113803 53.1000  C123        S</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt; 5:           373450  8.0500              S</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt; 6:           330877  8.4583              Q</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co"># split the data</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> cla_train<span class="sc">$</span>Survived,<span class="at">p =</span> <span class="fl">0.7</span>)</span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>xtrain <span class="ot">&lt;-</span> cla_train[split<span class="sc">$</span>Resample1]</span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>xtest <span class="ot">&lt;-</span> cla_train[<span class="sc">!</span>split<span class="sc">$</span>Resample1]</span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a><span class="co"># encode categorical variables - shorter way</span></span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a><span class="cf">for</span>(c <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&#39;Embarked&#39;</span>,<span class="st">&#39;Sex&#39;</span>,<span class="st">&#39;Cabin&#39;</span>)) {</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>    lbl <span class="ot">&lt;-</span> LabelEncoder<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>    lbl<span class="sc">$</span><span class="fu">fit</span>(<span class="fu">c</span>(xtrain[[c]], xtest[[c]]))</span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>    xtrain[[c]] <span class="ot">&lt;-</span> lbl<span class="sc">$</span><span class="fu">transform</span>(xtrain[[c]])</span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>    xtest[[c]] <span class="ot">&lt;-</span> lbl<span class="sc">$</span><span class="fu">transform</span>(xtest[[c]])</span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>}</span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a><span class="co">#&gt; The data contains blank values. Imputing them with &#39;NA&#39; </span></span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a><span class="co">#&gt; The data contains blank values. Imputing them with &#39;NA&#39; </span></span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a><span class="co">#&gt; The data contains blank values. Imputing them with &#39;NA&#39; </span></span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a><span class="co">#&gt; The data contains blank values. Imputing them with &#39;NA&#39; </span></span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a><span class="co">#&gt; The data contains blank values. Imputing them with &#39;NA&#39;</span></span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a><span class="co"># impute missing values</span></span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a>xtrain[, Age <span class="sc">:=</span> <span class="fu">replace</span>(Age, <span class="fu">is.na</span>(Age), <span class="fu">median</span>(Age, <span class="at">na.rm =</span> T))]</span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a>xtest[, Age <span class="sc">:=</span> <span class="fu">replace</span>(Age, <span class="fu">is.na</span>(Age), <span class="fu">median</span>(Age, <span class="at">na.rm =</span> T))]</span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a><span class="co"># drop these features</span></span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a>to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;PassengerId&#39;</span>,<span class="st">&#39;Ticket&#39;</span>,<span class="st">&#39;Name&#39;</span>)</span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a></span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a>xtrain <span class="ot">&lt;-</span> xtrain[,<span class="sc">-</span><span class="fu">c</span>(to_drop), with<span class="ot">=</span>F]</span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a>xtest <span class="ot">&lt;-</span> xtest[,<span class="sc">-</span><span class="fu">c</span>(to_drop), with<span class="ot">=</span>F]</span></code></pre></div>
<p>Now, our data is ready to be served for model training. Let’s do
it.</p>
<p><strong>KNN Classification</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>knn <span class="ot">&lt;-</span> KNNTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">k =</span> <span class="dv">2</span>,<span class="at">prob =</span> T,<span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>knn<span class="sc">$</span><span class="fu">fit</span>(<span class="at">train =</span> xtrain, <span class="at">test =</span> xtest, <span class="at">y =</span> <span class="st">&#39;Survived&#39;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>probs <span class="ot">&lt;-</span> knn<span class="sc">$</span><span class="fu">predict</span>(<span class="at">type =</span> <span class="st">&#39;prob&#39;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>labels <span class="ot">&lt;-</span> knn<span class="sc">$</span><span class="fu">predict</span>(<span class="at">type =</span> <span class="st">&#39;raw&#39;</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> labels)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.6385027</span></span></code></pre></div>
<p><strong>Naive Bayes Classification</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>nb <span class="ot">&lt;-</span> NBTrainer<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>nb<span class="sc">$</span><span class="fu">fit</span>(xtrain, <span class="st">&#39;Survived&#39;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> nb<span class="sc">$</span><span class="fu">predict</span>(xtest)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Warning: predict.naive_bayes(): more features in the newdata are provided as</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; there are probability tables in the object. Calculation is performed based on</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; features to be found in the tables.</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> pred)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; [1] 0.7771836</span></span></code></pre></div>
<p><strong>SVM Classification</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co">#predicts labels</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>svm <span class="ot">&lt;-</span> SVMTrainer<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>svm<span class="sc">$</span><span class="fu">fit</span>(xtrain, <span class="st">&#39;Survived&#39;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>pred <span class="ot">&lt;-</span> svm<span class="sc">$</span><span class="fu">predict</span>(xtest)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted=</span>pred)</span></code></pre></div>
<p><strong>Logistic Regression</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>lf <span class="ot">&lt;-</span> LMTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>lf<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;Survived&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">summary</span>(lf<span class="sc">$</span>model)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; stats::glm(formula = f, family = self$family, data = X, weights = self$weights)</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.830070   0.616894   2.967  0.00301 ** </span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; Pclass      -0.980785   0.192493  -5.095 3.48e-07 ***</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; Sex          2.508241   0.230374  10.888  &lt; 2e-16 ***</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; Age         -0.041034   0.009309  -4.408 1.04e-05 ***</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; SibSp       -0.235520   0.117715  -2.001  0.04542 *  </span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; Parch       -0.098742   0.137791  -0.717  0.47361    </span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt; Fare         0.001281   0.002842   0.451  0.65230    </span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#&gt; Cabin        0.008408   0.004786   1.757  0.07899 .  </span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; Embarked     0.248088   0.166616   1.489  0.13649    </span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 831.52  on 623  degrees of freedom</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 564.76  on 615  degrees of freedom</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt; AIC: 582.76</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> predictions)</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#&gt; [1] 0.8832145</span></span></code></pre></div>
<p><strong>Lasso Logistic Regression</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>lf <span class="ot">&lt;-</span> LMTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>lf<span class="sc">$</span><span class="fu">cv_model</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;Survived&quot;</span>, <span class="at">nfolds =</span> <span class="dv">5</span>, <span class="at">parallel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">cv_predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> pred)</span></code></pre></div>
<p><strong>Ridge Logistic Regression</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>lf <span class="ot">&lt;-</span> LMTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>, <span class="at">alpha=</span><span class="dv">0</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>lf<span class="sc">$</span><span class="fu">cv_model</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;Survived&quot;</span>, <span class="at">nfolds =</span> <span class="dv">5</span>, <span class="at">parallel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> lf<span class="sc">$</span><span class="fu">cv_predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> pred)</span></code></pre></div>
<p><strong>Random Forest</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>rf <span class="ot">&lt;-</span> RFTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">n_estimators =</span> <span class="dv">500</span>,<span class="at">classification =</span> <span class="dv">1</span>, <span class="at">max_features =</span> <span class="dv">3</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>rf<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;Survived&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>pred <span class="ot">&lt;-</span> rf<span class="sc">$</span><span class="fu">predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>rf<span class="sc">$</span><span class="fu">get_importance</span>()</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt;          tmp.order.tmp..decreasing...TRUE..</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; Sex                                67.80128</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; Fare                               57.97193</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; Age                                48.37045</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; Pclass                             24.64915</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; Cabin                              21.45972</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; SibSp                              13.51637</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; Parch                              10.45743</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; Embarked                           10.23844</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> pred)</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; [1] 0.7976827</span></span></code></pre></div>
<p><strong>Xgboost</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>xgb <span class="ot">&lt;-</span> XGBTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">objective =</span> <span class="st">&quot;binary:logistic&quot;</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>                      , <span class="at">n_estimators =</span> <span class="dv">500</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>                      , <span class="at">eval_metric =</span> <span class="st">&quot;auc&quot;</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>                      , <span class="at">maximize =</span> T</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>                      , <span class="at">learning_rate =</span> <span class="fl">0.1</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>                      ,<span class="at">max_depth =</span> <span class="dv">6</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>xgb<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;Survived&quot;</span>, <span class="at">valid =</span> xtest)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>pred <span class="ot">&lt;-</span> xgb<span class="sc">$</span><span class="fu">predict</span>(xtest)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> pred)</span></code></pre></div>
<p><strong>Grid Search</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>xgb <span class="ot">&lt;-</span> XGBTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">objective=</span><span class="st">&quot;binary:logistic&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>gst <span class="ot">&lt;-</span>GridSearchCV<span class="sc">$</span><span class="fu">new</span>(<span class="at">trainer =</span> xgb,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                             <span class="at">parameters =</span> <span class="fu">list</span>(<span class="at">n_estimators =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">50</span>),</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                             <span class="at">max_depth =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>                             <span class="at">n_folds =</span> <span class="dv">3</span>,</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>                             <span class="at">scoring =</span> <span class="fu">c</span>(<span class="st">&#39;accuracy&#39;</span>,<span class="st">&#39;auc&#39;</span>))</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>gst<span class="sc">$</span><span class="fu">fit</span>(xtrain, <span class="st">&quot;Survived&quot;</span>)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>gst<span class="sc">$</span><span class="fu">best_iteration</span>()</span></code></pre></div>
<p><strong>Random Search</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>rf <span class="ot">&lt;-</span> RFTrainer<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>rst <span class="ot">&lt;-</span> RandomSearchCV<span class="sc">$</span><span class="fu">new</span>(<span class="at">trainer =</span> rf,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>                             <span class="at">parameters =</span> <span class="fu">list</span>(<span class="at">n_estimators =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">50</span>), <span class="at">max_depth =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>)),</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>                             <span class="at">n_folds =</span> <span class="dv">3</span>,</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>                             <span class="at">scoring =</span> <span class="fu">c</span>(<span class="st">&#39;accuracy&#39;</span>,<span class="st">&#39;auc&#39;</span>),</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>                             <span class="at">n_iter =</span> <span class="dv">3</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>rst<span class="sc">$</span><span class="fu">fit</span>(xtrain, <span class="st">&quot;Survived&quot;</span>)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;In total, 3 models will be trained&quot;</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>rst<span class="sc">$</span><span class="fu">best_iteration</span>()</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt; $n_estimators</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; [1] 50</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; $max_depth</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; $accuracy_avg</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; [1] 0.7964744</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; $accuracy_sd</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; [1] 0.03090914</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; $auc_avg</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; [1] 0.7729436</span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co">#&gt; $auc_sd</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co">#&gt; [1] 0.04283084</span></span></code></pre></div>
<p>Let’s create some new feature based on target variable using target
encoding and test a model.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># add target encoding features</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>xtrain[, feat_01 <span class="sc">:=</span> <span class="fu">smoothMean</span>(<span class="at">train_df =</span> xtrain,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>                        <span class="at">test_df =</span> xtest,</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>                        <span class="at">colname =</span> <span class="st">&quot;Embarked&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>                        <span class="at">target =</span> <span class="st">&quot;Survived&quot;</span>)<span class="sc">$</span>train[[<span class="dv">2</span>]]]</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>xtest[, feat_01 <span class="sc">:=</span> <span class="fu">smoothMean</span>(<span class="at">train_df =</span> xtrain,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>                               <span class="at">test_df =</span> xtest,</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>                               <span class="at">colname =</span> <span class="st">&quot;Embarked&quot;</span>,</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>                               <span class="at">target =</span> <span class="st">&quot;Survived&quot;</span>)<span class="sc">$</span>test[[<span class="dv">2</span>]]]</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co"># train a random forest</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co"># Random Forest</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>rf <span class="ot">&lt;-</span> RFTrainer<span class="sc">$</span><span class="fu">new</span>(<span class="at">n_estimators =</span> <span class="dv">500</span>,<span class="at">classification =</span> <span class="dv">1</span>, <span class="at">max_features =</span> <span class="dv">4</span>)</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>rf<span class="sc">$</span><span class="fu">fit</span>(<span class="at">X =</span> xtrain, <span class="at">y =</span> <span class="st">&quot;Survived&quot;</span>)</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>pred <span class="ot">&lt;-</span> rf<span class="sc">$</span><span class="fu">predict</span>(<span class="at">df =</span> xtest)</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>rf<span class="sc">$</span><span class="fu">get_importance</span>()</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co">#&gt;          tmp.order.tmp..decreasing...TRUE..</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="co">#&gt; Sex                               69.787235</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt; Fare                              60.832089</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co">#&gt; Age                               52.982604</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="co">#&gt; Pclass                            24.419818</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt; Cabin                             21.419274</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="co">#&gt; SibSp                             13.112177</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="co">#&gt; Parch                             10.175269</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co">#&gt; feat_01                            6.675399</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co">#&gt; Embarked                           6.450819</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">actual =</span> xtest<span class="sc">$</span>Survived, <span class="at">predicted =</span> pred)</span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co">#&gt; [1] 0.8018717</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
